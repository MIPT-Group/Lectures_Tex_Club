\newpage
\lecture{12}{Интеграл Лебега для неотрицательных функций.}

\begin{theorem}
    Пусть $\forall n\in \N$ функция $f_n:\: X\to\oR$ измерима относительно $\CE$. Тогда
    функции
    \begin{align*}
         & f(x)=\sup_{n\in\N} f_n(x),\quad g(x)=\inf_{n\in\N}f_n(x), \\
         & F(x)=\overline{\lim_{n\to\infty}}f_n(x),\quad
        G(x)=\lim_{\overline{n\to\infty}}f_n(x)
    \end{align*}
    измеримы относительно $\CE$.

    \begin{proof}

        Докажем для функции $f$. Понятно, что \[
            f(x)>c\Rightarrow\exists n:\: f_n(x)>c.
        \] Поэтому, \[
            \{x:\: f(x)>c\}=\bigcup_{n=1}^{\infty}\{x:\: f_n(x)>c\}\in\CE.
        \]

        Инфинум легко сводится к супремуму: \[
            \inf_{n\in\N} f_n(x)=-\sup_{n\in\N}(-f_n(x)).
        \]

        Далее разберемся с верхним пределом: \[
            \overline{\lim_{n\to\infty}}f_n(x)=\lim_{n\to\infty}\underbrace{\sup_{k\geqslant n}f_k(x)}_{\varphi_n(x)}.
        \]
        В силу доказанного имеем $\varphi_n$~--- измеримы. Осталось заметить, что \[
            \varphi_{n+1}(x)\leqslant\varphi_n(x).
        \]
        Благодаря данному неравенству можно записать \[
            \lim_{n\to\infty}\sup_{k\geqslant n}f_k(x)=\inf_{n\in\N}\sup_{k\geqslant n} f_k(x)\text{~--- измеримо.}
        \]
        С нижним пределом аналогично.

    \end{proof}
\end{theorem}

\begin{next0}
    Если $f_n$ измерима $\forall n\in\N$ и $f(x)=\lim\limits_{n\to\infty}f_n(x)$, то $f$~--- измерима (относительно $\CE$).

    В самом деле, в данном случае $\lim\limits_{n\to\infty}f_n(x)=\overline{\lim\limits_{n\to\infty}} f_n(x)$.
\end{next0}

\subsection{Простые функции.}

\begin{definition}
    Функция $s:\: X\to\R$ называется \mdef{простой}, если ее множество значений конечно, то есть
    \begin{gather*}
        \exists n\in\N\quad \exists \{a_i\}_{i=1}^n\subset \R:\quad \exists \{A_i\}_{i=1}^n\subset X:\quad A_i\cap A_j=\varnothing\ (i\neq j):\quad
        X = \bigsqcup_{i=1}^nA_i:\\
        s(x)=\sum_{i=1}^n a_{i}1_{A_i}(x),\quad \forall x\in X.
    \end{gather*}
\end{definition}

\begin{remark}
    По определению простые функции не принимает бесконечных значений. Кроме того,
    простая функция $s$ измерима относительно $\CE$ тогда и только тогда, когда $A_i\in\CE\ \forall i\in\overline{1,n}$,
    так как $A_i=s^{-1}(\{a_i\})$.
\end{remark}

\begin{claim}
    Пусть $f:\: X\to[0,\,+\infty]$ измерима относительно $\CE$. Тогда существует последовательность
    $\{s_n\}_{n=1}^{\infty}$ простых измеримых относительно $\CE$ функций таких, что
    \begin{enumerate}
        \item $\forall x\in X\quad 0\leqslant s_n(x)\leqslant s_{n+1}(x)\leqslant f(x)\quad\forall n\in\N$.
        \item $\forall x\in X\quad \lim_{n\to\infty} s_n(x)=f(x)$.
    \end{enumerate}

    \begin{proof}

        Построим последовательность монотонных функций $\varphi_n$ (см. рис. \ref{fig:lect12:stairs}).

        \begin{figure}[!ht]
            \centering
            \input{images/stairs.tikz}
            \caption{Построение $\varphi_n$.}
            \label{fig:lect12:stairs}
        \end{figure}

        Возьмем $y=t$, построим <<лестницу>>. Во-первых, $\varphi_n(t)=n,\ \forall t\geqslant n$. При $t<n$ вставим
        лестницу с шагом $2^{-n}$.

        Рассмотрим $s_n(x):=\varphi_n(f(x))$. Во-первых, $\varphi_n$~--- борелевская, поэтому $s_n$~--- измерима.
        Далее, очевидно, $s_n$~--- простая.
        Далее, по построению, \begin{gather*}
            0\leqslant\varphi_n(t)\leqslant\varphi_{n+1}(t)\leqslant t,\\
            \varphi_n(x)\to t\text{ при } x\to\infty.
        \end{gather*}
        Следовательно, $s_n(x)\to f(x)\quad \forall x\in X$.

    \end{proof}
\end{claim}

\subsection{Интеграл Лебега для неотрицательных функций.}

Пусть на измеримом пространстве $(X,\, \CE)$ задана $\sigma$"=аддитивная мера $\mu:\: \CE\to[0,\,+\infty]$.
Пусть $s:\: X\to[0,\, +\infty)$~--- простая измеримая относительно $\CE$ функция.

\begin{definition}
    Интегралом называется следующая сумма:
    \[
        \int sd\mu:=\sum_{a\in s(X)}a\cdot\mu\left(s^{-1}(\{a\})\right).
    \]

    То есть, если $X=\bigsqcup\limits_{i=1}^n A_i$ и $s=\sum\limits_{i=1}^n a_i 1_{A_i}$, то
    \[
        \int sd\mu=\sum_{i=1}^n a_i\cdot\mu(A_i).
    \]

    \begin{remark}
        Если $a_i=0$, а $\mu(A_i)=+\infty$, то $a_i\cdot\mu(A_i)=0$.
    \end{remark}
\end{definition}

Часто рассматривается интеграл по измеримому множеству.
\begin{definition}
    Пусть $A\in\CE$. Тогда интеграл:
    \[
        \int_{A}sd\mu:=\int 1_A\cdot s d\mu=\int\left(0\cdot 1_{A^C}+
        \sum_{i=1}^n a_i\cdot 1_{A\cap A_i}\right)d\mu=\sum_{i=1}^n a_i\mu(A\cap A_i).
    \]

    \begin{remark}
        В частности, \[
            \int_X sd\mu=\int sd\mu,
        \]
        так как $1_X=1$.
    \end{remark}
\end{definition}

\begin{claim}
    Если $s_1$ и $s_2$~--- простые, измеримые относительно $\CE$ функции, то
    \[
        \int(s_1+s_2)d\mu=\int s_1d\mu+\int s_2d\mu.
    \]
\end{claim}

\begin{claim}
    Пусть $s:\: X\to[0,\, +\infty]$~--- простая измеримая относительно $\CE$ функция.
    Тогда \[
        \nu(A)=\int_A sd\mu\text{~--- $\sigma$"=аддитивная мера.}
    \]

    \begin{proof}

        Ранее было доказано, что $\nu$~--- $\sigma$"=аддитивна на $\sigma$"=алгебре $\CE$ тогда и только тогда, когда \[
            \forall\{A_n\}_{n=1}^{\infty}\subset\CE:\quad \nu\left(\bigcup_{k=1}^{n}A_k\right)
            \xrightarrow[n\to\infty]{}\nu\left(\bigcup_{k=1}^{\infty}A_k\right).
        \]
        Пусть $s=\sum\limits_{i=1}^m a_i1_{A_i}.$
        Тогда \[
            \nu\left(\bigcup_{k=1}^n A_k\right)=\sum_{i=1}^m a_i\cdot\mu\left(A_i\cap\bigcup_{k=1}^nA_k\right)
            \xrightarrow[n\to\infty]{}\sum_{i=1}^m a_i\mu\left(A_i\cap\bigcup_{k=1}^{\infty}A_k\right)=
            \nu\left(\bigcup_{k=1}^{\infty}A_k\right).
        \]

    \end{proof}
\end{claim}

\begin{definition}
    Пусть функция $f:\: X\to[0,\, +\infty]$ измерима относительно $\CE$. Тогда \[
        \int fd\mu:=\sup\left\{\int sd\mu\ \middle|\ \begin{array}{l}
            s:\: X\to[0,\, +\infty)\text{~--- простая измеримая,} \\
            s\leqslant f\text{ на всем } X.
        \end{array} \right\}
    \]

    \begin{remark}
        Говорят, что функция $s$, определенная выше, \mdef{подпирает} $f$.
    \end{remark}
\end{definition}

\begin{theorem}[Леви, о монотонной функции]
    Пусть функция $f_n:\: X\to[0,\, +\infty]\ \forall n\in\N$ измерима относительно $\CE$.
    Пусть \[
        f_{n+1}(x)\geqslant f_n(x)\quad \forall x\in X\quad \forall n\in\N,
        \quad f(x)=\lim_{n\to\infty}=\sup_{n\in\N} f_n(x).
    \]
    Тогда \[
        I=\int fd\mu=\lim_{n\to\infty}\underbrace{\int f_nd\mu}_{I_n}.
    \]

    \begin{remark}
        То есть теорема утверждает, что можно переставлять знаки интеграла и предела.
    \end{remark}

    \begin{proof}

        Для начала заметим, что \[
            f_n(x)\leqslant f_{n+1}(x)\leqslant f(x)\quad\forall x\in X\quad \forall n\in\N\quad
            \Rightarrow \quad I_{n}\leqslant I_{n+1}\leqslant I.
        \]

        Пусть $J=\sup_{n}I_n\Rightarrow J\leqslant I$. Осталось доказать, что $J\geqslant I$.

        Для этого достаточно доказать, что для любой простой измеримой относительно $\CE$ функции $s:\: s\leqslant f$
        выполнено \[
            \sup_{n}\int f_nd\mu\geqslant\int sd\mu=\sup_{c\in(0,\, 1)}c\int sd\mu.
        \]

        Следовательно, достаточно доказать для любой фиксированных $s$ и $c\in(0,\, 1)$, что \[
            \sup_{n}\int f_n d\mu\geqslant c\cdot\int sd\mu.
        \]

        Заметим, что если на множестве $A\in\CE$ выполнено $f_n\geqslant cs$, то \[
            \int_A f_nd\mu\geqslant c\int_A sd\mu.
        \]

        Рассмотрим такие множества: $A_n=\{x:\: f_n(x)\geqslant c\cdot s(x)\}$.
        Заметим следующую вещь: \[
            f_n(x)\leqslant f(x),\, f_n(x)\xrightarrow[n\to\infty]{}f(x)\Rightarrow
            \forall x\in X \quad \exists N:\: \forall n>N:\quad f_n(x)\geqslant c\cdot s(x).
        \]
        В самом деле, если $s(x)=0$ это очевидно. Если же $s(x)>0$, то $c\cdot s(x)<s(x)<f(x)$.

        Итак, \[
            \forall x\quad \exists n\in\N\quad x\in A_n\Rightarrow X=\bigcup_{n=1}^{\infty}A_n.
        \]
        Тогда \[
            c\int sd\mu=c\int_X sd\mu=\lim_{n\to\infty} c\int_{\bigcup_{k=1}^n A_k} sd\mu,
        \]
        так как $\nu(A)=\int_A sd\mu$~--- $\sigma$"=аддитивная мера.

        Далее, так как $A_n\subset A_{n+1}\ \forall n\in\N$, получаем \[
            \bigcup_{k=1}^n A_k=A_n\Rightarrow c\int_{\bigcup_{k=1}^n A_k}sd\mu=
            c\int_{A_n}sd\mu\leqslant\int_{A_n}f_nd\mu\leqslant
            \int f_nd\mu\leqslant\sup_{n}\int f_nd\mu.
        \]

    \end{proof}
\end{theorem}

\begin{claim}
    Пусть функции $f,\, g:\: X\to[0,\, +\infty]$ измеримы относительно $\CE$. Тогда \[
        \int(f+g)d\mu=\int fd\mu+\int gd\mu.
    \]

    \begin{proof}

        По доказанному ранее, $\exists\{s_n\}_{n=1}^{\infty},\, \{\varphi_n\}_{n=1}^{\infty}$ простых измеримых относительно $\CE$ функций
        такие, что \begin{gather*}
            s_n(x)\leqslant s_{n+1}(x)\leqslant f(x)\quad \forall x\in X\quad \forall n\in\N,\\
            \varphi_n(x)\leqslant \varphi_{n+1}(x)\leqslant g(x)\quad \forall x\in X\quad \forall n\in\N,\\
            s_n\xrightarrow[n\to\infty]{}f(x),\quad
            \varphi_n\xrightarrow[n\to\infty]{}g(x)\quad \forall x.
        \end{gather*}

        Заметим, что \begin{gather*}
            \int fd\mu=\lim_{n\to\infty}\int s_nd\mu,\\
            \int gd\mu=\lim_{n\to\infty}\int \varphi_nd\mu,
        \end{gather*}
        по теореме о монотонной сходимости.
        Следовательно, \[
            \int fd\mu+\int gd\mu=\lim_{n\to\infty}\left(\int s_nd\mu+\int \varphi_nd\mu\right).
        \]
        Так как $s_n,\, \varphi_n$~--- простые, то \[
            \lim_{n\to\infty}\left(\int s_nd\mu+\int \varphi_nd\mu\right)=
            \lim_{n\to\infty}\int \left(s_n+\varphi_n\right)d\mu.
        \]
        Снова по теореме о монотонной сходимости получаем: \[
            \lim_{n\to\infty}\int \left(s_n+\varphi_n\right)d\mu=
            \int\lim_{n\to\infty}(s_n+\varphi_n)d\mu=
            \int(f+g)d\mu.
        \]

    \end{proof}
\end{claim}