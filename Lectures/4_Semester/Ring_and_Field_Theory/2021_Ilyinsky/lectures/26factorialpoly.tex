\subsection{Многочлены над факториальным кольцом}

Теперь мы докажем факториальность кольца многочленов над факториальным кольцом. \textbf{До конца раздела} зафиксируем факториальное кольцо $K$ и его поле частных $F = \quot(K)$.

\begin{proposition}
	Каждый неразложимый в $K$ элемент прост в $K[x]$.
\end{proposition}

\begin{proof}
	Пусть $p$ "--- неразложимый элемент в $K$. Рассмотрим факторкольцо $K[x] / (p) \cong (K / (p))[x]$ и заметим, что $K / (p)$ "--- область целостности в силу факториальности кольца $K$. Но тогда и $K[x] / (p) \cong (K / (p))[x]$ "--- область целостности, поэтому $p$ прост в $K[x]$.
\end{proof}

\begin{corollary}
	Пусть $p \in K[x]$ "--- неразложимый элемент, $\deg{p} = 0$. Тогда $p$ прост в $K[x]$.
\end{corollary}

\begin{definition}
	Пусть $g \in K[x] \backslash \{0\}$. Обозначим через $c(g)$ наибольший общий делитель коэффициентов многочлена $g$. Многочлен $g$ называется \textit{примитивным}, если $c(g) \sim 1$.
\end{definition}

\begin{note}
	Очевидно, если многочлен $f \in K[x] \backslash \{0\}$ неприводим (то есть неразложим в $K[x]$), то он примитивен.
\end{note}

\begin{proposition}
	Если многочлены $\widehat{f}, \widehat{g} \in K[x] \backslash \{0\}$ примитивны, то многочлен $\widehat{f}\widehat{g}$ тоже примитивен.
\end{proposition}

\begin{proof}
	Предположим, что $\widehat{f}\widehat{g}$ не примитивен, тогда существует неразложимый элемент $p \in K$ такой, что $p \mid \widehat{f}\widehat{g}$. Но $p$ также прост в $K[x]$, поэтому $p \mid \widehat{f}$ или $p \mid \widehat{g}$, что невозможно в силу примитивности многочленов $\widehat{f}, \widehat{g}$.
\end{proof}

\begin{corollary}
	Если для некоторых элементов $A, B \in K \backslash \{0\}$ и примитивных многочленов $\widehat{f_1}, \dotsc, \widehat{f_k}, \widehat{g_1}, \dotsc, \widehat{g_s} \in K[x]$ выполнено равенство $A\widehat{f_1}\dotsm\widehat{f_k} = B\widehat{g_1}\dotsm\widehat{g_s}$, то тогда $A \sim B$ и $\widehat{f_1}\dotsm\widehat{f_k} \sim \widehat{g_1}\dotsm\widehat{g_s}$.
\end{corollary}

\begin{proof}
	Многочлены $\widehat{f_1}\dotsm\widehat{f_k}$ и $\widehat{g_1}\dotsm\widehat{g_s}$ примитивны, поэтому $c(A\widehat{f_1}\dotsm\widehat{f_k}) = A$ и $c(B\widehat{g_1}\dotsm\widehat{g_s}) = B$, откуда $A \sim B$. Сокращая на $A$ и $B$, получаем требуемое.
\end{proof}

\begin{proposition}
	Пусть $f \in K[x]$ "--- примитивный многочлен. Тогда $f$ неприводим над $K[x]$ $\lra$ $f$ неприводим над $F[x]$.
\end{proposition}

\begin{proof}~
	\begin{itemize}
		\item[$\la$] Пусть $f$ приводим над $K[x]$, то есть $f = gh$ для некоторых $g, h \in K[x] \backslash (\{0\} \cup K[x]^*)$, причем $g, h \not\sim 1$. Тогда $\deg{g}, \deg{h} \ge 1$ в силу примитивности многочлена $f$. Но тогда $g, h \not\in F[x]^*$, что противоречит неприводимости многочлена $f$ над $F[x]$.
		\item[$\ra$] Пусть $f$ приводим над $F[x]$, то есть $f = gh$ для некоторых $g, h \in F[x] \backslash (\{0\} \cup F[x]^*)$ таких, что $\deg{g}, \deg{h} \ge 1$. Тогда $f = \frac{A}{B}\widehat{g}\widehat{h}$, где $\widehat{g}, \widehat{h} \in K[x]$ "--- примитивные многочлены положительной степени, $\frac AB \in F$. Но тогда $Bf = A\widehat{g}\widehat{h}$, и, в силу примитивности, $f \sim \widehat{g}\widehat{h}$, что противоречит неприводимости многочлена $f$ над $K[x]$.\qedhere
	\end{itemize}
\end{proof}

\begin{note}
	Аналогично доказательству $\ra$ можно получить, что у любого ненулевого многочлена из $K[x]$ существует разложение на неприводимые над $K[x]$ многочлены, пользуясь факториальностью кольца $F[x]$.
\end{note}

\begin{corollary}
	Пусть $f \in K[x]$ "--- неприводимый многочлен, $\deg{f} \ge 1$. Тогда $f$ прост в $K[x]$.
\end{corollary}

\begin{proof}
	Поскольку $f$ неприводим над $K[x]$, то $f$ примитивен и потому неприводим над $F[x]$. Тогда, в силу факториальности кольца $F[x]$, $f$ прост в $F[x]$, и если $f \mid gh$ для некоторых $g, h \in K[x]$, то без ограничения общности $g = fq$, $q \in F[x]$. Тогда $g = \frac{A}{B}f\widehat{q}$, где $\widehat{q} \in K[x]$ "--- примитивный многочлен, $\frac{A}{B} \in F$. Тогда, аналогично доказанному, выделим из многочлена $g$ множитель $c(g)$ и получим, что $f \mid g$.
\end{proof}

\begin{theorem}
	Кольцо $K[x]$ факториально.
\end{theorem}

\begin{proof}
	В $K[x]$ существует разложение для каждого ненулевого многочлена, и каждый неприводимый над $K[x]$ многочлен прост, поэтому $K[x]$ факториально.
\end{proof}