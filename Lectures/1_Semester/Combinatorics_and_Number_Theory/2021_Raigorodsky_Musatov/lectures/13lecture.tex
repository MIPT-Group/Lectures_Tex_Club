\subsubsection*{Диаграммы Юнга}

Продолжим говорить про задачу с неупорядоченными разбиениями. Пусть у нас есть некоторое разбиение числа $n$:
\[
	n = x_1 + \ldots + x_t.
\]
Раз порядок не важен, то для удобства его можно потребовать
\[
	x_1 \le x_2 \le \ldots \le x_t.
\]
Теперь просто будем говорить, что разбиение, которое удовлетворяет данному условию, будет представителем класса эквивалентных разбиений (то есть таких, у которых набор слагаемых одинаков).

Несложно понять, как визуализировать данное представление --- это просто пирамидка из кубиков, где число кубиков на каждом слое соответствует своему слагаемому:

%%%% Нарисовать. Здесь должна быть картинка 07:02 c 12й лекции
\textcolor{red}{Здесь должна быть картинка, которая когда-нибудь возможно появится. Можно в гугле найти.}

\begin{note}
	В теоремах ниже полагается, что разбиение рассматривается без учёта порядка.
\end{note}

\begin{theorem}
	Количество разбиений числа $n$ на не более $k$ слагаемых равно количеству разбиений числа $n + k$ на ровно $k$ слагаемых.
\end{theorem}

\begin{proof}
	Нарисуем диаграммы Юнга для какого-то произвольного случая.
	%%%% Нарисовать n = 8, k = 4. Слева 2 2 4, справа 1 3 3 5
	
	Несложно заметить, что если мы добавим слева столбец высоты $k$ к любой диаграмме Юнга, соответствующей разбиению числа $n$, то получим диаграмму Юнга для разбиения $n + k$.
\end{proof}

\begin{theorem}
	Количество разбиений числа $n$ на не более $k$ слагаемых равно количеству разбиений числа $n + \frac{k(k + 1)}{2}$ на ровно $k$ \textit{различных} слагаемых.
\end{theorem}

\begin{proof}
	Нарисуем диаграммы Юнга:
	%%%% Нарисовать n = 8, k = 4, Слева 2 2 4, справа 1 4 5 8
	идея в том, чтобы сложить диаграмму справа с треугольником высоты $k$ и длиной первого слоя $k + 1$.
\end{proof}

\begin{theorem}
	Количество разбиений числа $n$ на не более $k$ слагаемых равно количеству разбиений числа $n$ на слагаемые, величина каждого из которых не более $k$.
\end{theorem}

\begin{proof}
	Надо просто транспонировать диаграмму Юнга для числа $n$:
	%%% Нарисовать n = 8, k <= 4. Слева 2 2 4, справа 1 1 3 3
\end{proof}

\subsubsection*{Формальный ряд}

Рассмотрим как чисто алгебраическое выражение следующее бесконечное произведение:
\[
	\prodl_{n = 1}^\infty (1 - x^n) = (1 - x)(1 - x^2)(1 - x^3)(1 - x^4)\ldots
\]
Мы \textbf{не будем подставлять никаких $x$}. Мы просто хотим раскрыть данное выражение и посмотреть, что получится.

\begin{proposition} \label{infReveal}
	Если раскрыть все скобки, то получится выражение
	\[
		\prodl_{n = 1}^\infty (1 - x^n) = 1 - x - x^2 + x^5 + x^ 7 - \ldots
	\]
\end{proposition}

Как получается любое слагаемое, отличное от 1? Если оно имеет степень $n$, то оно задаётся выражением
\[
	(-x^{n_1})(-x^{n_2})\ldots(-x^{n_t}) = (-1)^t x^n
\]
То есть оно получается путём набора степени $n$ из $t$ скобок, где возьмём $x^{n_i}$ (в остальных выбираем 1). В силу рассматриваемого бесконечного произведения, верно 2 утверждения:
\begin{align*}
	&n = n_1 + \ldots + n_t,
	\\
	&\forall i, j \in [1; t]\ \ n_i \neq n_j.
\end{align*}

При этом нам не важен порядок, в котором мы выбираем множители из скобок.

Выражение, которое записано справа в утверждении \ref{infReveal}, является приведённым многочленом. Можно ли как-то сказать, какие $x^n$ останутся и с каким коэффициентом (до этого мы говорили об элементарном слагаемом, которое получается при раскрытии без приведения)?

\begin{theorem}
	Если $n \neq \frac{3k^2 \pm k}{2}$ ни при каком $k$, то коэффициент при $x^n$ равен нулю. Иначе равен $(-1)^k$.
\end{theorem}

Из этой теоремы можно получить ещё одну для разбиений числа $n$. Обозначим за $n_{\text{чёт}}$~---~ количество разбиений числа $n$ на чётное число различных слагаемых, и еще введём $n_{\text{нечёт}}$.

\begin{theorem}
	Если $n \neq \frac{3k^2 \pm k}{2}$ для любых $k$, то $n_{\text{чёт}} = n_{\text{нечёт}}$. Иначе $n_{\text{чёт}} - n_{\text{нечёт}} = (-1)^k$.
\end{theorem}

\subsection{Линейные рекуррентные соотношения с постоянными коэффициентами}

\begin{note}
	Далее: $\N = \{0, 1, 2 \ldots\}$.
\end{note}

\begin{definition}
	Последовательность $\{y_n\}_{n = 0}^\infty$ удовлетворяет \textit{линейному рекуррентному соотношению (ЛРС) $k$-го порядка с постоянными коэффициентами}, если для любого $n \in \N$ верно:
	\[
		a_k \cdot y_{n + k} + a_{k - 1} \cdot y_{n + k - 1} + \ldots + a_1 \cdot y_{n + 1} + a_0 \cdot y_n = 0,
	\]
	где $a_0, \ldots, a_k \in \Cm,\ a_k \neq 0,\ a_0 \neq 0$.
\end{definition}

\begin{note}
	Последовательность задана однозначно, если заданы конкретные \linebreak числа $y_0, \ldots, y_{k - 1}$.
\end{note}

Ключевой вопрос: можно ли написать явную формулу для $y_n$?

\begin{proposition}
	Для линейных рекуррентных соотношений любого порядка существует общая формула.
\end{proposition}

\begin{enumerate}
	\item $k = 1,\ a_0, a_1 \in \Cm$:
	\[
		a_1y_{n + 1} + a_0y_n = 0.
	\]
	Или же
	\[
		y_{n + 1} = \left(-\frac{a_0}{a_1}\right)y_n.
	\]
	Несложно понять и доказать общую формулу:
	\[
		y_{n} = y_0 \cdot \left(-\frac{a_0}{a_1}\right)^n.
	\]
	
	\item $k = 2,\ a_0, a_1, a_2 \in \Cm$:
	\[
		a_2y_{n + 2} + a_1y_{n + 1} + a_0y_n = 0.
	\]
	Составим \textit{характеристическое уравнение}:
	\[
		a_2x^2 + a_1x + a_0 = 0.
	\]
	Просто заменили все $y_i$ на $x^i$. Решений у полученного уравнения всегда 2 в поле $\Cm$. Введём обозначения для этих корней $\lambda_1$ и $\lambda_2$.
	\begin{theorem}
		Пусть $\lambda_1 \neq \lambda_2$. Тогда
		\begin{enumerate}
			\item $\forall c_1, c_2 \in \Cm$ последовательность $y_n = c_1\lambda_1^n + c_2\lambda_2^n$ является решением данного ЛРС.
			\item Если $\{y_n\}_{n = 0}^\infty$ удовлетворяет данному ЛРС, то $\exists c_1, c_2 \such y_n = c_1\lambda_1^n + c_2\lambda_2^n$.
		\end{enumerate}
	\end{theorem}

	\begin{proof}~
		\begin{enumerate}
			\item Подставим выражение для $y_n$ в левую часть ЛРС:
			\begin{multline*}
				a_2(c_1\lambda_1^{n + 2} + c_2\lambda_2^{n + 2}) + a_1(c_1\lambda_1^{n + 1} + c_2\lambda_2^{n + 1}) + a_0(c_1\lambda_1^n + c_2\lambda_2^n) =
				\\ =
				c_1\lambda_1^n\underbrace{(a_2\lambda_1^2 + a_1\lambda_1 + a_0)}_{0} + c_2\lambda_2^n\underbrace{(a_2\lambda_2^2 + a_1\lambda_2 + a_0)}_{0} = 0
			\end{multline*}
			
			\item Мы знаем, что $\{y_n\}_{n = 0}^\infty$ удовлетворет ЛРС. Составим систему
			\[
				\System{
					&{c_1 + c_2 = y_0,}
					\\
					&{c_1\lambda_1 + c_2\lambda_2 = y_1.}
				}
			\]
			Определитель её матрицы равен $\Delta = \lambda_2 - \lambda_1 \neq 0$. Значит, решение $c_1^*, c_2^*$ существует и единственно. Рассмотрим последовательность $y_n^* = c_1^*\lambda_1^n + c_2^*\lambda_2^n$. При этом уже по первому пункту $y_n^*$ тоже является решением ЛРС. Более того, $y_0 = y_0^*$ и $y_1 = y_1^*$. Таким образом, последовательности $y_n$ и $y_n^*$ совпадают.
		\end{enumerate}
	\end{proof}

	\begin{example}
		Последовательность Фибоначчи задаётся ЛРС второго порядка:
		\[
		F_{n + 2} - F_{n + 1} - F_n = 0,\ \ F_0 = 0,\ F_1 = 1.
		\]
		Характеристическим уравнением будет
		\[
		x^2 - x - 1 = 0.
		\]
		Корни $\lambda_{1, 2} = \frac{1 \pm \sqrt{5}}{2}$. Отсюда общая формула
		\[
		F_n = c_1\left(\frac{1 + \sqrt{5}}{2}\right)^n + c_2\left(\frac{1 - \sqrt{5}}{2}\right)^n,
		\]
		где $c_{1, 2}$ находятся из выбранных начальных значений.
	\end{example}

	\begin{theorem}
		Пусть $\lambda := \lambda_1 = \lambda_2$. Тогда
		\begin{enumerate}
			\item $\forall c_1, c_2 \in \Cm$ последовательность $y_n = (c_1n + c_2)\lambda^n$ является решением данного ЛРС.
			
			\item Если $\{y_n\}$ является решением, то $\exists c_1, c_2 \in \Cm \such y_n = (c_1n + c_2)\lambda^n$.
		\end{enumerate}
	\end{theorem}
	
	\begin{proof}~
		\begin{enumerate}
			\item Подставим выражение $y_n$ в левую часть ЛРС:
			\begin{multline*}
				a_2(c_1(n + 2) + c_2)\lambda^{n + 2} + a_1(c_1(n + 1) + c_2)\lambda^{n + 1} + a_0(c_1 n + c_2)\lambda^n =
				\\
				\lambda^n\left(c_1 n(a_2\lambda^2 + a_1\lambda + a_0) + c_2(a_2\lambda^2 + a_1\lambda + a_0) + a_2 \cdot 2c_1 \cdot \lambda^2 + a_1 \cdot c_1 \cdot \lambda\right) =
				\\
				\lambda^n\left(c_1\lambda(2a_2 \lambda + a_1)\right)
			\end{multline*}
			При этом мы воспользовались тем, что
			\[
				a_2\lambda^2 + a_1\lambda + a_0 = 0
			\]
			Значит, по теореме Виета:
			\[
				2\lambda = -\frac{a_1}{a_0} \Ra 2a_2\lambda + a_1 = 0
			\]
			Отсюда следует, что и оставшееся выражение тоже обнуляется. Следовательно, наша последовательность является решением данного ЛРС.
			
			\item Абсолютно аналогично случаю $\lambda_1 \neq \lambda_2$.
		\end{enumerate}
	\end{proof}

	\item Общий случай $a_0, \ldots, a_k \in \Cm,\ a_k \neq 0,\ a_0 \neq 0$:
	\[
		a_k y_{n + k} + a_{k - 1} y_{n + k - 1} + \ldots + a_1 y_{n + 1} + a_0 y_n = 0
	\]
	Так же, как и для $k = 2$, составим характеристическое уравнение:
	\[
		a_k x^k + a_{k - 1} x^{k - 1} + \ldots + a_1 x + a_0 = 0
	\]
	Слева записано не что иное, как многочлен степени $k$. Если обозначить за $P_m(x)$ - произвольный многочлен степени \textit{не выше} $m$ от $x$, то выражение перепишется как
	\[
		P_k(x) = 0
	\]
	Согласно основной теореме алгебры, у любого многочлена с комплексными коэффициентами степени $k$ существует ровно $k$ комплексных корней (не обязательно разных), то есть
	\[
		\exists \lambda_1, \ldots, \lambda_k \in \Cm \such P_k(x) = a_k(x - \lambda_1) \cdot \ldots \cdot (x - \lambda_k)
	\]
	Разобьём эти $k$ корней на $r$ групп совпадающих. Представителей групп переобозначим как $\mu_1, \ldots, \mu_r$, а размеры групп обозначим за $m_1, \ldots, m_r$.
	\begin{theorem}~
		\begin{enumerate}
			\item Для любых многочленов $P_{m_1 - 1}(n), \ldots, P_{m_r - 1}(n)$ последовательность $\{y_n\}_{n = 0}^\infty$ вида:
			\[
				y_n = P_{m_1 - 1}(n) \cdot \mu^n_1 + \ldots + P_{m_r - 1}(n) \cdot \mu^n_r
			\]
			удовлетворяет решению данного ЛРС.
			
			\item Если $\{y_n\}_{n = 0}^\infty$ удовлетворяет решению данного ЛРС, то существуют многочлены $P_{m_1 - 1}(n), \ldots, P_{m_r - 1}(n)$ такие, что можно выписать $y_n$ в общем виде, описанном выше.
		\end{enumerate}
	\end{theorem}

	\begin{proof}
		Оставляется читателю в качестве домашнего задания (не входит в читаемый курс).
	\end{proof}
\end{enumerate}