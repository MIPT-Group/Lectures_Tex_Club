\begin{theorem} (Кантора о равномерной непрерывности)
	Если $f$ непрерывна на $[a; b]$, то она равномерно непрерывна на нём.
\end{theorem}

\begin{proof}
	От противного. Пусть $f$ неравномерно непрерывна на $[a; b]$:
	\[
		\exists \eps_0 \such \left(\forall \delta > 0\ \exists x, y \in [a; b],\ |x - y| < \delta\right)\ \ |f(x) - f(y)| \ge \eps_0
	\]
	Построим $\{x_n\}$ и $\{y_n\}$, последовательно выбирая $\delta = 1, \frac{1}{2}, \ldots, \frac{1}{n}, \ldots$. То есть:
	\[
		\exists \{x_n\},\ \{y_n\} \subset [a; b] \such |x_n - y_n| < \frac{1}{n}\ \ |f(x_n) - f(y_n)| \ge \eps_0
	\]
	Так как последовательность $\{x_n\}$ ограничена, то по теореме Больцано-Вейерштрасса из неё можно выделить сходящуюся подпоследовательность:
	\[
		\exists \{x_{n_k}\} \subset \{x_n\} \such \liml_{k \to \infty} x_{n_k} = x_0 \in [a; b]
	\]
	Тогда
	\[
		|x_{n_k} - y_{n_k}| < \frac{1}{n_k} \lra x_{n_k} - \frac{1}{n_k} < y_{n_k} < x_{n_k} + \frac{1}{n_k}
	\]
	Это нам даёт, что
	\[
		\liml_{k \to \infty} y_{n_k} = x_0
	\]
	А раз функция непрерывна, то верны равенства
	\begin{align*}
		&\liml_{k \to \infty} f(x_{n_k}) = f(x_0)
		\\
		&\liml_{k \to \infty} f(y_{n_k}) = f(x_0)
	\end{align*}
	Получили противоречие с условием, что $|f(x_n) - f(y_n)| \ge \eps_0$
\end{proof}

\begin{theorem} (Признак равномерной непрерывности)
	Если $f$ дифференцируема на промежутке $I$ и имеет ограниченную производную на этом промежутке, то она равномерно непрерывна 
\end{theorem}

\begin{proof}
	Нужно доказать, что
	\[
		\forall \eps > 0\ \exists \delta > 0 \such \forall x_1, x_2 \in I,\ |x_1 - x_2| < \delta\ \ |f(x_1) - f(x_2)| < \eps
	\]
	По теореме Лагранжа
	\[
		\exists \xi \such f(x_2) - f(x_1) = f'(\xi)(x_2 - x_1)
	\]
	Так как производная ограничена, то
	\[
		\exists M > 0 \such \forall x \in I\ \ |f'(x)| \le M
	\]
	Поэтому положим $\delta := \frac{\eps}{M}$ и тогда следует, что
	\[
		|f(x_2) - f(x_1)| \le M \cdot |x_2 - x_1| < \eps
	\]
\end{proof}

\subsubsection*{Геометрический смысл равномерной непрерывности}

% Нарисовать. Последняя минута 14й лекции Лукашова 2019го года

\subsection{Формула Тейлора}


%%% Его стоило дать ещё в 4м параграфе, так Лукашов сказал
\begin{definition}
	Функция $f$ называется $n$ раз дифференцируемой в точке $x_0$, если её производные $f', f'', \ldots, f^{(n - 1)}$ определены в некоторой окрестности точки $x_0$ и $f^{(n - 1)}$ дифференцируема в точке $x_0$.
\end{definition}

\begin{lemma}
	Для любой функции $f$, $n$ раз дифференцируемой в точке $x_0$, существует единственный многочлен $P_n(f, x)$ степени не выше $n$ такой, что $P_n^{(k)}(f, x_0) = f^{(k)}(x_0)$ для $k = 0, 1, \ldots, n$. При этом
	\[
		P_n(f, x) = f(x_0) + f'(x_0)(x - x_0) + \frac{f''(x_0)}{2!}(x - x_0)^2 + \ldots + \frac{f^{(n)}(x_0)}{n!}(x - x_0)^n
 	\]
 	Этот многочлен называется \textit{многочленом Тейлора функции $f$ в точке $x_0$ степени $n$}.
\end{lemma}

\begin{proof}
	Докажем, что приведённый многочлен удовлетворяет всем условиям, сказанным в лемме. То есть докажем, что существует многочлен, подходящий лемме. Сразу из определения следует, что
	\[
		P_n(f, x_0) = f(x_0)
	\]
	Теперь возьмём $k$-ю производную данного многочлена. Несложно понять, что слагаемые $(x - x_0)^j$, где $j < k$, сократятся полностью. Для остальных имеем
	\[
		\left((x - x_0)^j\right)^{(k)} = j(j - 1) \ldots (j - k + 1)(x - x_0)^{j - k}
	\]
	То есть
	\[
		P_n^{(k)}(f, x) = \suml_{j = k}^n \frac{f^{(j)}(x_0)}{j!} \cdot j(j - 1) \ldots (j - k + 1)(x - x_0)^{j - k} = \suml_{j = k}^n \frac{f^{(j)}(x_0)}{(j - k)!} (x - x_0)^{j - k}
	\]
	В точке $x = x_0$ это нам даёт
	\[
		P_n^{(k)}(f, x_0) = \frac{f^{(k)}(x_0)}{0!} = f^{(k)}(x_0)
	\]
	
	Теперь докажем единственность: пусть даны 2 различных многочлена $P$ и $Q$ степени не выше $n$, удовлетворяющие условиям леммы. Тогда
	\[
		(P - Q)^{(n)}(x_0) = 0,\ k = 0, \ldots, n
	\]
	При этом разность многочленов - тоже многочлен вида
	\[
		(P - Q)(x) = a_0 + a_1(x - x_0) + \ldots + a_n(x - x_0)^n
	\]
	Последовательно рассматривая все $k$-е производные получим, что
	\[
		a_0 = a_1 = \ldots = a_n = 0
	\]
	То есть $P(x) = Q(x)$
\end{proof}

\begin{note}
	При подстановке $x = x_0$ можно заметить, что полное слагаемое имеет вид
	\[
		\frac{f^{(j)}(x_0)}{(j - k)!}(x_0 - x_0)^{j - k}
	\]
	Казалось бы, при $j = k$ мы имеем дело с неопределённостью. Но помним, что производная - это предел при $x \to x_0$, который мы вначале считаем, а потом уже делаем подстановку $x = x_0$. Здесь точно такая же ситуация - мы вначале должны \textbf{полностью досчитать производную}, а потом подставлять $x = x_0$. То есть вначале будет $(x - x_0)^0 = 1$, и только потом подстановка $x$ (которая с единицей уже ничего не сделает).
\end{note}

\begin{lemma} \label{lemTaylor}
	Пусть $\varphi$ и $\psi$ $n + 1$ раз дифференцируемы в окрестности точки $x_0$, а также
	\begin{align*}
		&\varphi(x_0) = \varphi'(x_0) = \ldots = \varphi^{(n)}(x_0) = \psi(x_0) = \psi'(x_0) = \ldots = \psi^{(n)}(x_0) = 0
		\\
		&\psi', \psi'', \ldots, \psi^{(n)} \neq 0 \text{ в } \mc{U}_{\delta}(x_0)
	\end{align*}
	Тогда $\forall x \in \mc{U}_{\delta}(x_0)$ существует $\xi$ между $x_0$ и $x$ такое, что
	\[
		\frac{\varphi(x)}{\psi(x)} = \frac{\varphi^{(n + 1)}(\xi)}{\psi^{(n + 1)}(\xi)}
	\]
\end{lemma}

\begin{proof}
	По теореме Коши
	\[
		\exists \xi_1 \such \frac{\varphi(x)}{\psi(x)} = \frac{\varphi(x) - \varphi(x_0)}{\psi(x) - \psi(x_0)} = \frac{\varphi'(\xi_1)}{\psi'(\xi_1)}
	\]
	В силу того, что $\varphi'(x_0) = \psi'(x_0) = 0$, а также $\varphi$ и $\psi$ снова удовлетворяют условиям теоремы Коши, получим
	\[
		\exists \xi_2 \such \frac{\varphi'(\xi_1) - \varphi'(x_0)}{\psi'(\xi_1) - \psi(x_0)} = \frac{\varphi''(\xi_2)}{\psi''(\xi_2)} = \frac{\varphi(x)}{\psi(x)}
	\]
	И так продолжаем до $\xi = \xi_{n + 1}$:
	\[
		\frac{\varphi^{(n)}(\xi_n) - \varphi^{(n)}(x_0)}{\psi^{(n)}(\xi_n) - \psi^{(n)}(x_0)} = \frac{\varphi^{(n + 1)}(\xi)}{\psi^{(n + 1)}(\xi)}
	\]
\end{proof}

\begin{theorem} (Формула Тейлора с остаточным членом в форме Лагранжа)
	Если $f$ дифференцируема $n + 1$ раз в окрестности $U_\delta(x_0)$, то $\forall x \in U_\delta(x_0)$ существует $\xi$ между $x_0$ и $x$ такое, что
	\begin{multline*}
		f(x) = P_n(f, x) + \frac{f^{(n + 1)(\xi)}}{(n + 1)!}(x - x_0)^{n + 1} = \\
		f(x_0) + f'(x_0)(x - x_0) + \ldots + \frac{f^{(n)}(x_0)}{n!}(x - x_0)^n + \frac{f^{(n + 1)}(\xi)}{(n + 1)!}(x - x_0)^{n + 1}
	\end{multline*}
\end{theorem}

\begin{proof}
	Рассмотрим функции
	\begin{align*}
		&\varphi(x) := f(x) - P_n(f, x)
		\\
		&\psi(x) := (x - x_0)^{n + 1}
	\end{align*}
	Заметим, что данные функции удовлетворяют условиям леммы \ref{lemTaylor}. То есть
	\[
		\frac{f(x) - P_n(f, x)}{(x - x_0)^{n + 1}} = \frac{f^{(n + 1)}(\xi)}{(n + 1)!}
	\]
	Следовательно
	\[
		f(x) = P_n(f, x) + \frac{f^{(n + 1)}(\xi)}{(n + 1)!}(x - x_0)^{n + 1}
	\]
\end{proof}

\begin{theorem} (Формула Тейлора с остаточным членом в форме Пеано)
	Если $f$ $n$ раз дифференцируема в точке $x_0$, то
	\[
		f(x) = f(x_0) + f'(x_0)(x - x_0) + \ldots + \frac{f^{(n)}(x_0)}{n!}(x - x_0)^n + o\left((x - x_0)^n\right),\ x \to x_0
	\]
\end{theorem}

\begin{proof}
	Положим
	\begin{align*}
		&\varphi(x) = f(x) - P_n(f, x)
		\\
		&\psi(x) = (x - x_0)^n
	\end{align*}
	Отсюда
	\[
		\varphi(x_0) = \ldots = \varphi^{(n - 2)}(x_0) = \psi(x_0) = \ldots = \psi^{(n - 2)}(x_0) = 0
	\]
	То есть по лемме \ref{lemTaylor} $\exists \xi$ между $x$ и $x_0$ такое, что
	\[
		\frac{f(x) - P_n(f, x)}{(x - x_0)^n} = \frac{f^{(n - 1)}(\xi) - P_n^{(n - 1)}(f, \xi)}{n! \cdot (\xi - x_0)}
	\]
	Посчитаем предел
	\begin{multline*}
		\liml_{x \to x_0} \frac{f^{(n - 1)}(x) - P_n^{(n - 1)}(f, x)}{x - x_0} = \liml_{x \to x_0} \frac{f^{(n - 1)}(x) - f^{(n - 1)}(x_0)}{x - x_0} - \liml_{x \to x_0} \frac{P_n^{(n - 1)}(f, x) - P_n^{(n - 1)}(f, x_0)}{x - x_0} = \\
		f^{(n)}(x_0) - P_n^{(n)}(f, x_0) = 0
	\end{multline*}
	Это означает, что
	\[
		\liml_{x \to x_0} \frac{f^{(n - 1)}(\xi) - P_n^{(n - 1)}(f, \xi)}{n! \cdot (\xi - x_0)} = \liml_{x \to x_0} \frac{f(x) - P_n(f, x)}{(x - x_0)^n} = 0
	\]
	Следовательно
	\[
		f(x) = P_n(f, x) + o((x - x_0)^n),\ x \to x_0
	\]
\end{proof}

\begin{theorem} (Единственность разложения по формуле Тейлора)
	Если 
	\[
		f(x) = a_0 + a_1(x - x_0) + \ldots + a_n(x - x_0)^n + o\left((x - x_0)^n\right),\ x \to x_0
    \]
    и 
    \[
    	f(x) = b_0 + b_1(x - x_0) + \ldots + b_n(x - x_0)^n + o\left((x - x_0)^n\right),\ x \to x_0
    \] то
	\[
		a_k = b_k,\ k = 0, 1, \ldots, n
	\]
\end{theorem}

\begin{proof}
	Рассмотрим разность этих многочленов:
	\[
		f(x) - f(x) = (a_0 - b_0) + (a_1 - b_1)(x - x_0) + \ldots + (a_n - b_n)(x - x_0)^n + o\left((x - x_0)^n\right) = 0,\ x \to x_0
	\]
	В предельном переходе получим
	\[
		\liml_{x \to x_0} (a_0 - b_0) + (a_1 - b_1)(x - x_0) + \ldots + (a_n - b_n)(x - x_0)^n + o\left((x - x_0)^n\right) = a_0 - b_0 = 0
	\]
	Отсюда $a_0 = b_0$. Теперь разность имеет вид:
	\[
		f(x) - f(x) = (a_1 - b_1)(x - x_0) + \ldots + (a_n - b_n)(x - x_0)^n + o((x - x_0)^n) = 0,\ x \to x_0
	\]
	При этом $x - x_0 \neq 0$. Значит, можно разделить уравнение на $(x - x_0)$ и снова взять предел. В этот раз получим $a_1 = b_1$. Делая так $n + 1$ раз, придём к нужному утверждению
	\[
		a_k = b_k,\ k = 0, 1, \ldots, n
	\]
\end{proof}

\begin{corollary}
	Если $f(x)$ $n$ раз дифференцируема в точке $x_0$ и
	\[
		f(x) = a_0 + a_1(x - x_0) + \ldots + a_n(x - x_0)^n + o\left((x - x_0)^n\right),\ x \to x_0
	\]
	то
	\[
		a_k = \frac{f^{(k)}(x_0)}{k!},\ k = 0, 1, \ldots, n
	\]
	Причём формула существенна только для $n > 1$. Для $n = 1$ - разложение равносильно дифференцируемости в точке $x_0$.
\end{corollary}

\begin{example}
	Данная функция имеет асимптотическое разложение, но не дважды дифференцируема в нуле (то есть коэффициенты не совпадут с теми, что есть в формуле Тейлора)
	\[
		f(x) = \System{
			&x^3 \sin \frac{1}{x},\ x \neq 0
			\\
			&0,\ x = 0
		}
	\]
	Из определения сразу видно, что есть разложение
	\[
		f(x) = a_0 + a_1(x - 0) + a_2(x - 0)^2 + o((x - 0)^2)
	\]
	Первая производная имеет вид
	\[
		f'(x) = \System{
			&3x^2 \sin \frac{1}{x} - x \cos \frac{1}{x},\ x \neq 0
			\\
			&0,\ x = 0
		}
	\]
	Посчитаем $f''(0)$:
	\begin{multline*}
		f''(0) = \liml_{\Delta x \to 0} \frac{f'(0 + \Delta x) - f'(0)}{0 + \Delta x - 0} = \liml_{\Delta x \to 0} \frac{3\Delta x^2 \sin \frac{1}{\Delta x} - \Delta x \cos \frac{1}{\Delta x}}{\Delta x} = \\
		\liml_{\Delta x \to 0} \left(3 \Delta x \sin \frac{1}{\Delta x} - \cos \frac{1}{\Delta x}\right) \text{ - расходится}
	\end{multline*}
\end{example}

\begin{definition}
	Если $x_0 = 0$, то формулы Тейлора называются также \textit{формулами Маклорена}
\end{definition}

\subsubsection*{Формулы Маклорена основных элементарных функций}

\begin{enumerate}
	\item $e^x:$ $\left(e^x\right)^{(n)} = e^x \Ra e^x = 1 + x + \frac{x^2}{2!} + \ldots + \frac{x^n}{n!} + o(x^n),\ x \to 0$
	
	\item $\sin x:$ $\left(\sin x\right)^{(n)} = \sin(x + \frac{n\pi}{2})$. То есть
	\[
		\left(\sin x\right)^{(n)}(0) = \sin \frac{n\pi}{2} = \System{
			&{0,\ n = 2k}
			\\
			&{(-1)^{k - 1},\ n = 2k - 1}
		},\ k \in \N
	\]
	Так как синус имеет любую производную, то для любого $n$, если $k$ - это частное от деления на 2, формулу Маклорена можно записать так:
	\[
		\sin x = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \ldots + (-1)^{k - 1} \frac{x^{2k - 1}}{(2k - 1)!} + o(x^{2k}),\ x \to 0
	\]
	Формула Маклорена в виде Лагранжа также имеет вид:
	\[
		\sin x = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \ldots + (-1)^{k} \frac{x^{2k + 1}}{(2k + 1)!} \sin \left(\xi + \frac{2k + 1}{2}\pi\right)
	\]
	
	\item $\cos x:$ $\left(\cos x\right)^{(n)} = \cos (x + \frac{n\pi}{2})$. То есть
	\[
		\left(\cos x\right)^{(n)}(0) = \cos \frac{n\pi}{2} = \System{
			&{0,\ n = 2k - 1}
			\\
			&{(-1)^k,\ n = 2k}
		}
	\]
	Отсюда формула Маклорена для косинуса имеет вид:
	\[
		\cos x = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \ldots + \frac{(-1)^k}{(2k)!}x^{2k} + o(x^{2k}),\ x \to 0
	\]
	
	\item $(1 + x)^\alpha:$ $\left((1 + x)^\alpha\right)^{(n)} = \alpha(\alpha - 1)\ldots(\alpha - n + 1)(1 + x)^{\alpha - n} = n! C_{\alpha}^n (1 + x)^{\alpha - n}$, где $\alpha \notin \N$
	\[
		(1 + x)^\alpha = 1 + \alpha x + \frac{\alpha (\alpha - 1)}{2!}x^2 + \ldots + \underbrace{\frac{\alpha (\alpha - 1) \ldots (\alpha - n + 1)}{n!}}_{C_\alpha^n}x^n + o(x^n),\ x \to 0
	\]
	Если $\alpha \in \N$, то на каком-то шаге производная станет нулём и будет таковой дальше. (То есть можно будет получить точное разложение, бином Ньютона)
	
	\item $\ln (1 + x):$ $\left(\ln (1 + x)\right)^{(n)} = \left((1 + x)^{-1}\right)^{(n - 1)}$ То есть \[
		\left(\ln (1 + x)\right)^{(n)}= (-1) \cdot (-2) \cdot \ldots \cdot (-1 - (n - 2)) \cdot (1 + x)^{-1 - (n - 1)} = (-1)^{n - 1} \cdot (n - 1)! \cdot (1 + x)^{-n}
	\]
	Формула Маклорена для логарифма имеет вид:
	\[
		\ln(1 + x) = x - \frac{x^2}{2} + \frac{x^3}{3} - \ldots + (-1)^{n - 1}\frac{x^n}{n} + o(x^n)
	\]
\end{enumerate}

\begin{note}
	Если $f$ - чётная функция, то в формуле Маклорена все нечётные степени имеют нулевые коэффициенты. Если $f$ - нечётная, то четные степени имеют нулевые коэффициенты.
\end{note}

\begin{proof}
	Пусть $f$ - чётная функция. Посчитаем $f'(-x)$ по определению:
	\[
		f'(-x) = \liml_{\Delta x \to 0} \frac{f(-x + \Delta x) - f(-x)}{\Delta x} = \liml_{\Delta x \to 0} \frac{f(x - \Delta x) - f(x)}{\Delta x} = \liml_{t \to 0} \frac{f(x + t) - f(x)}{-t} = -f'(x)
	\]
	То есть $f'(0) = -f'(0)$. Значит, $f'(0) = 0$.
	
	Аналогично доказывается, что если $f$ - нечётная, то $f'$ - чётная.
\end{proof}

\begin{addition}
	Рассмотрим функцию
	\[
		f(x) = \System{
		&{\frac{\sin x}{x},\ x \neq 0}
		\\
		&{1,\ x = 0}
		}
	\]
	Она непрерывна на $\R$. Раз мы знаем разложение синуса, то можно записать выражение
	\[
		f(x) = 1 - \frac{x^2}{3!} + \frac{x^4}{5!} - \ldots + (-1)^{k - 1} \frac{x^{2k - 2}}{(2k - 1)!} + o(x^{2k - 1}),\ x \to 0
	\]
	Является ли оно формулой Тейлора? Как оказывается, да. Но для доказательства нужно показать, что $f(x)$ дифференцируема $n$ раз в нуле, что сделать крайне трудно.
\end{addition}