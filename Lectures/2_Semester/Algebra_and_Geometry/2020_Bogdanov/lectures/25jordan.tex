\section{Жорданова нормальная форма и ее приложения}

\subsection{Жорданова нормальная форма}

\begin{definition}
	Пусть $F$ "--- поле, $\lambda_0 \in F$. \textit{Жордановой клеткой} размера $k \in \N$ с собственным значением $\lambda_0$ называется матрица $J_k(\lambda_0) \in M_k(F)$, имеющая следующий вид:
	\[J_k(\lambda_0) := \begin{pmatrix}
		\lambda_0 & 1 & \dots & 0 & 0 \\ 
		0 & \lambda_0 & \ddots & \ddots & 0 \\ 
		\vdots & \ddots & \ddots & \ddots & \vdots \\ 
		0 & \ddots & \ddots & \lambda_0 & 1 \\ 
		0 & 0 & \dots & 0 & \lambda_0
	\end{pmatrix}\]
	
	Cчитается также, что $J_k := J_k(0)$.
\end{definition}

\begin{definition}
	Пусть $F$ "--- поле, $A \in M_n(F)$. Матрица $A$ имеет \textit{жорданов вид}, если она имеет блочно-диагональный вид, в котором каждый блок является жордановой клеткой, то есть имеет следующий вид для некоторых $k_1, \dotsc, k_m \in \N$ и $\lambda_1, \dotsc, \lambda_m \in F$:
	\[A = \left(\begin{array}{@{}cccc@{}}
		\cline{1-1}
		\multicolumn{1}{|c|}{J_{k_1}(\lambda_1)} & 0 & \dots & 0\\
		\cline{1-2}
		0 & \multicolumn{1}{|c|}{J_{k_2}(\lambda_2)} & \dots & 0\\
		\cline{2-2}
		\vdots & \vdots & \ddots & \vdots\\
		\cline{4-4}
		0 & 0 & \dots & \multicolumn{1}{|c|}{J_{k_m}(\lambda_m)}\\
		\cline{4-4}
	\end{array}\right)\]
\end{definition}

\begin{definition}
	Пусть $V$ "--- линейное пространство, $\phi \in \mc L(V)$. Если в некотором базисе матрица оператора $\phi$ имеет жорданов вид, то она называется \textit{жордановой нормальной формой} оператора $\phi$, а соответствующий базис "--- его \textit{жордановым базисом}.
\end{definition}

\textbf{До конца раздела} зафиксируем линейное пространство $V$ над полем $F$ и положим $n := \dim{V}$, а также зафиксируем оператор $\phi \in \mathcal L(V)$ такой, что  $\Chi_\phi(\lambda)$ имеет вид $\eqref*{charpol}$.

\begin{note}
	В силу предположения выше, многочлен $\Chi_\phi(\lambda)$ можно представить в виде произведения многочленов $P_1 := (\lambda_1 - \lambda)^{\alpha_1}, \dotsc, P_k := (\lambda_k - \lambda)^{\alpha_k}$. Эти многочлены попарно взаимно просты.
\end{note}

\begin{definition}
	Пусть $\lambda_i$ "--- собственное значение оператора $\phi$. \textit{Корневым подпространством}, соответствующим $\lambda_i$, называется $V^{\lambda_i} := \ke{P_i(\phi)} \hm{=} \ke(\phi_{\lambda_i})^{\alpha_i}$.
\end{definition}

\begin{note}
	Поскольку $V_{\lambda_i} = \ke{\phi_{\lambda_i}}$, то $V_{\lambda_i} \le V^{\lambda_i}$, но обратное включение верно не всегда. Кроме того, $V = V^{\lambda_1} \oplus \dotsb \oplus V^{\lambda_k}$ по уже доказанному утверждению.
\end{note}

\begin{proposition}
	Пусть $\lambda_i$, $\lambda_j$ "--- различные собственные значения оператора $\phi$. Тогда оператор $\phi_{\lambda_i}|_{V^{\lambda_j}} \in \mathcal{L}(V^{\lambda_j})$ "--- невырожденный.
\end{proposition}

\begin{proof}
	Отметим сначала, что сужение $\phi_{\lambda_i}|_{V^{\lambda_j}}$ корректно, поскольку $V^{\lambda_j}$ инвариантно относительно $\phi$. Тогда, поскольку выполнены равенства $V^{\lambda_i} \cap V^{\lambda_j} = \{\overline{0}\}$ и $V_{\lambda_i} = \ke{\phi_{\lambda_i}} \le V^{\lambda_i}$, имеем $\ke{\phi_{\lambda_i}|_{V^{\lambda_j}}} = V^{\lambda_j} \cap \ke{\phi_{\lambda_i}} \hm{=} \{\overline{0}\}$, что и означает невырожденность оператора.
\end{proof}

\begin{proposition}
	Пусть $\lambda_i$ "--- собственное значение оператора $\phi$. Тогда выполнено следующее равенство:
	\[V^{\lambda_i} = \{\overline{v} \in V: \exists m \in \mathbb{N}: (\phi_{\lambda_i})^m(\overline{v}) = \overline{0}\}\]
\end{proposition}

\begin{proof}
	Нетривиально только включение $(\ge)$. Пусть $\overline{v} \in V$ "--- вектор такой, что $(\phi_{\lambda_i})^m(\overline{v}) = \overline{0}$ для некоторого $m \in \N$. Представим его в виде $\overline{v} = \overline{v_1} + \dots + \overline{v_k}$, где $\overline{v_j} \in V^{\lambda_j}$ для каждого $j \in \{1, \dotsc, k\}$, тогда выполнено следующее равенство:
	\[(\phi_{\lambda_i})^m(\overline{v_1}) + \dots +  (\phi_{\lambda_i})^m(\overline{v_k}) = \overline{0}\]
	
	В силу инвариантности, для каждого $j \in \{1, \dotsc, k\}$ выполнено $(\phi_{\lambda_i})^m(\overline{v_j}) \in V^{\lambda_j}$, поэтому каждый такой вектор равен $\overline 0$ по свойству прямой суммы. Но для каждого индекса $j \in \{1, \dotsc n\} \bs \{i\}$ оператор $\phi_{\lambda_i}|_{V^{\lambda_j}}$ "--- невырожденный, откуда $\overline{v_j} = \overline{0}$. Значит, $\overline{v} = \overline{v_i} \in V^{\lambda_i}$, и получено требуемое.
\end{proof}

\begin{note}
	Утверждение выше означает, что если вектор $\overline{v} \in V$ обнуляется при действии какой-либо степени оператора $\phi_{\lambda_i}$, то он также обнуляется при действии оператора $\phi$ в некоторой степени, не превосходящей $\alpha_i$.
\end{note}

\begin{definition}
	Пусть $\psi \in \mathcal{L}(V)$. Оператор $\psi$ называется \textit{нильпотентным}, если существует $m \in \mathbb{N}$ такое, что $\psi^m = 0$.
\end{definition}

\begin{note}
	Все собственные значения оператора являются корнями любого аннулирующего многочлена этого оператора, а для нильпотентного оператора $\psi$ многочлен $x^m$ является аннулирующим, поэтому его единственное собственное значение "--- это $0$.
\end{note}

\begin{definition}
	Пусть $\psi \in \mathcal{L}(V)$ "--- нильпотентный оператор. Подпространство $U \le V$ называется \textit{циклическим} относительно $\psi$, если оно инвариантно относительно $\psi$ и существует вектор $\overline{v} \in V$ такой, что $U$ "--- минимальное по включению инвариантное подпространство, содержащее $\overline{v}$.
\end{definition}

\begin{note}
	Если подпространство $U \le V$ "--- циклическое относительно нильпотентного оператора $\psi \in \mc L(V)$ и вектора $\overline{v} \in V$, то $U = \langle\overline{v}, \psi(\overline{v}), \psi^2(\overline{v}), \dots\rangle$, причем порождающий набор конечен в силу нильпотентности оператора $\psi$.
\end{note}

\begin{definition}
	Пусть $\psi \in \mathcal{L}(V)$ "--- нильпотентный оператор, $\overline{v} \in V \bs \{\overline 0\}$. \textit{Высотой} вектора $\overline{v}$ относительно $\psi$ называется наименьшее $n \in \mathbb{N}$ такое, что $\psi^n(\overline{v}) = \overline{0}$.
\end{definition}

\begin{proposition}
	Пусть $\psi \in \mathcal{L}(V)$ "--- нильпотентный оператор, и пусть векторы ${\overline{v_1}, \dots, \overline{v_k} \in V \bs \{\overline 0\}}$ имеют попарно различные высоты относительно $\psi$. Тогда эти векторы образуют линейно независимую систему.
\end{proposition}

\begin{proof}
	Предположим, что это не так, тогда существует нетривиальная линейная комбинация с коэффициентами $\alpha_1, \dotsc, \alpha_k \in F$, равная нулю:
	\[\alpha_1\overline{v_1} + \dots + \alpha_k\overline{v_k} = \overline{0}\]
	
	Пусть $\overline{v_i}$ "--- вектор с наибольшей высотой $n_i$, коэффициент при котором не равен нулю. Применяя к данному равенству $\psi^{n_i - 1}$, получим, что $\alpha_i\psi^{n_i-1}(\overline{v_i}) = \overline{0}$. Значит, $\alpha_i = 0$, что противоречит нашему предположению.
\end{proof}

\begin{corollary}
	Пусть $\psi \in \mathcal{L}(V)$ "--- нильпотентный оператор, $U \le V$ "--- циклическое подпро-    ст\-ран-ство, порожденное вектором $\overline{v} \in V \bs \{\overline 0\}$ высоты $n$. Тогда {система $(\overline{v}, \psi(\overline{v}), \dots, \psi^{n-1}(\overline{v}))$} образует базис в $U$.
\end{corollary}

\begin{proof}
	Как уже было отмечено, $U = \langle\overline{v}, \psi(\overline{v}), \psi^2(\overline{v}), \dots\rangle$, тогда, поскольку высота $\overline{v}$ равна $n$, $U = \langle\overline{v}, \psi(\overline{v}), \dots, \psi^{n - 1}(\overline{v})\rangle$. Кроме того, данная система линейно независима по только что доказанному утверждению.
\end{proof}

\begin{note}
	Матрица оператора $\psi$ в базисе $e = (\psi^{n-1}(\overline{v}), \dots, \psi(\overline{v}), \overline{v})$ имеет вид жордановой клетки размера $n$: $\psi \leftrightarrow_e J_n \in M_n(F)$.
\end{note}

\begin{proposition}
	Пусть $\psi \in \mathcal{L}(V)$ "--- нильпотентный оператор, $\overline{v} \in V$ "--- вектор наибольшей высоты $n$, и $U \le V$ "--- циклическое подпространство, порожденное $\overline{v}$. Тогда существует $W$ "--- прямое дополнение $U$ в $V$, инвариантное относительно $\psi$.
\end{proposition}

\begin{proof}
	Отметим сначала, что вектор $\overline{v}$ из условия определен корректно: в силу нильпотентности $\psi$ все векторы в $V$ имеют высоты, причем ограниченные сверху. Выберем инвариантное подпространство $W \le V$ наибольшей размерности такое, что $W \cap U \hm{=} \{\overline{0}\}$ (оно точно существует, потому что по меньшей мере $\{\overline{0}\}$ удовлетворяет условию). Если $U \oplus W = V$, то утверждение доказано. Если же $U \oplus W \hm{\ne} V$, выберем $\overline{x} \not\in U \oplus W$. Поскольку в наборе $\overline{x}, \psi(\overline{x}), \psi^2(\overline{x}), \dots, \overline{0}$ первый вектор не лежит в $U \oplus W$, а последний "--- лежит, то в некоторый момент происходит <<скачок>> из-за пределов $U \oplus W$ в $U \oplus W$. Пусть без ограничения общности это происходит на первом шаге, и уже $\psi(\overline{x}) \in U \oplus W$. По свойству прямой суммы, $\psi(\overline{x}) = \overline{u} + \overline{w}$, и, так как $U$ порождено $\overline{v}$, то $\overline{u} = \alpha_0\overline{v_0} + \dots + \alpha_{n - 1}\overline{v_{n - 1}}$, где $\overline{v_i} = \psi^{i}(\overline{v})$. Тогда:
	\[\psi(\overline{x}) = \alpha_0\overline{v_0} + \dots + \alpha_{n - 1}\overline{v_{n - 1}} + \overline{w}\]
	
	Поскольку $n$ "--- наибольшая высота в $V$, то $\overline{0} = \psi^n(\overline{x}) = \psi^{n-1}(\psi(\overline{x}))$, тогда, применив $\psi^{n - 1}$ к обеим частям равенства, получим:
	\[\overline{0} = \alpha_0\psi^{n - 1}(\overline{v_0}) + \psi^{n - 1}(\overline{w})\]
	
	Поскольку сумма $U \oplus W$ "--- прямая, оба слагаемых должны быть равны нулю: $\alpha_0 = 0$ и $\psi^{n - 1}(\overline{w}) = \overline{0}$. Рассмотрим теперь вектор $\overline{x'} \hm{=} \overline{x} - \alpha_1\overline{v_0} - \dots - \alpha_{n-1}\overline{v_{n-2}} \not\in U \oplus W$, так как иначе вектор $\overline{x}$ тоже лежал бы в $U \oplus W$. Кроме того:
	\[\psi(\overline{x'}) = \psi(\overline{x}) - \alpha_1\overline{v_1} - \dots - \alpha_{n-1}\overline{v_{n-1}} = \overline{w}\]
	
	Значит, $(U \oplus W) + \langle\overline{x'}\rangle = U \oplus W \oplus \langle\overline{x'}\rangle = U \oplus (W \oplus \langle\overline{x'}\rangle)$. Пространство $W \oplus \langle\overline{x'}\rangle$ "--- тоже инвариантное, причем $(W \oplus \langle\overline{x'}\rangle) \cap U = \{\overline{0}\}$ "--- противоречие с максимальностью $W$.
\end{proof}

\begin{corollary}
	Пусть $\psi \in \mathcal{L}(V)$ "--- нильпотентный оператор. Тогда $V$ раскладывается в прямую сумму циклических подпространств.
\end{corollary}

\begin{proof}
	Проведем индукцию по размерности $V$. База, $\dim{V} = 0$, тривиальна. Докажем переход. Выберем в $V$ вектор $\overline{v}$ наибольшей высоты и порожденное им циклическое подпространство $U_0$, тогда $\exists W$ "--- инвариантное, причем $V = U_0 \oplus W$. Для $W$ и $\psi|_W$ предположение индукции верно, поэтому и $V$ раскладывается в прямую сумму циклических подпостранств $U_0 \oplus U_1 \oplus \dots \oplus U_m$. Отметим также, что размерности циклических подпространств, построенных таким образом, будут невозрастать.
\end{proof}

\begin{theorem}[о существовании жордановой нормальной формы]
	Пусть $\phi \in \mathcal{L}(V)$, причем $\Chi_\phi$ имеет вид $\eqref*{charpol}$. Тогда у $\phi$ есть жорданова нормальная форма.
\end{theorem}

\begin{proof}
	$V = V^{\lambda_1} \oplus \dots \oplus V^{\lambda_k}$, причем $\forall i: \phi_{\lambda_i}|_{V^{\lambda_i}}$ "--- нильпотентный оператор, значит, как уже было доказано, он раскладывается в прямую сумму циклических подпространств и потому имеет жорданов базис $e_i$. В этом базисе $\phi_{\lambda_i}|_{V^{\lambda_i}}$ имеет жорданову нормальную форму с нулями на главной диагонали:
	\[\phi_{\lambda_i}|_{V^{\lambda_i}} \leftrightarrow_e \left(\begin{array}{@{}cccc@{}}
		\cline{1-1}
		\multicolumn{1}{|c|}{J_{k_1}} & 0 & \dots & 0\\
		\cline{1-2}
		0 & \multicolumn{1}{|c|}{J_{k_2}} & \dots & 0\\
		\cline{2-2}
		\vdots & \vdots & \ddots & \vdots\\
		\cline{4-4}
		0 & 0 & \dots & \multicolumn{1}{|c|}{J_{k_m}}\\
		\cline{4-4}
	\end{array}\right)\]
	
	В этом же базисе оператор $\phi|_{V^{\lambda_i}}$ имеет следующую жорданову нормальную форму:
	\[\phi|_{V^{\lambda_i}} \leftrightarrow_e \left(\begin{array}{@{}cccc@{}}
		\cline{1-1}
		\multicolumn{1}{|c|}{J_{k_1}(\lambda_i)} & 0 & \dots & 0\\
		\cline{1-2}
		0 & \multicolumn{1}{|c|}{J_{k_2}(\lambda_i)} & \dots & 0\\
		\cline{2-2}
		\vdots & \vdots & \ddots & \vdots\\
		\cline{4-4}
		0 & 0 & \dots & \multicolumn{1}{|c|}{J_{k_m}(\lambda_i)}\\
		\cline{4-4}
	\end{array}\right)\]
	
	Объединение жордановых базисов $e_i$ в $V^{\lambda_i}$ дает искомый жорданов базис в $V$.
\end{proof}

\begin{note}
	Существует и более конструктивный подход к получению жорданова базиса для нильпотентного оператора.
	
	Пусть $\psi \in \mathcal{L}(V)$ "--- нильпотентный, $k$ "--- наибольшая высота вектора в $V$ относительно $\psi$. Положим $V_i := \ke{\psi^i}$ "--- пространство векторов высоты не большей, чем $i$. Теперь будем специальным образом выбирать прямые дополнения $V_{i - 1}$ в $V_i$, двигаясь сверху вниз.
	
	Выберем $U_k$ "--- прямое дополнение $V_{k - 1}$ в $V_k$ (тогда все ненулевые векторы в $U_k$ имеют высоту $k$, поскольку $U_k \cap V_{k - 1} = \{\overline{0}\}$). Заметим теперь, что $\psi(U_k) \le V_{k - 1}$, причем все ненулевые векторы в $\psi(U_k)$ имеют высоту $k - 1$, то есть $\psi(U_k) \cap V_{k - 2} = \{\overline{0}\}$. Значит, можно выбрать $U_{k-1}$ "--- такое прямое дополнение $V_{k - 2}$ в $V_{k - 1}$, что $\psi(U_k) \le U_{k - 1}$. Таким образом мы построим $U_k, \dots, U_1 \le V$ ($U_1 := V_1$) такие, что $\forall i \hm{\in} \{1, \dots, k\}: \psi(U_i) \le U_{i - 1}$.
	
	Покажем теперь, что при $k > 1$ линейно независимая система $(\overline{v_1}, \dots, \overline{v_t}) \subset U_k$ под действием $\psi$ переходит в линейно независимую систему $(\psi(\overline{v_1}), \dots, \psi(\overline{v_t})) \subset U_{k - 1}$. Это верно потому, что $\alpha_1\psi(\overline{v_1}) + \dots + \alpha_t\psi(\overline{v_t}) = \psi(\alpha_1\overline{v_1} + \dots + \alpha_t\overline{v_t}) = \psi(\overline{v})$, где $\overline{v}$ "--- вектор	высоты $k$ (если линейная комбинация нетривиальна). Это позволяет изобразить пространство $V$ графически следующим образом:
	\[\begin{array}{@{}rccccc@{}}
		\cline{2-2}
		U_k \left\{\right.&\multicolumn{1}{|c|}{U_{k}} &&&&\\
		\cline{2-3}
		U_{k - 1} \left\{\right.&\multicolumn{1}{|c|}{\psi(U_k)} & \multicolumn{1}{c|}{W_{k - 1}} &&&\\
		\cline{2-4}
		U_{k - 2} \left\{\right.&\multicolumn{2}{|c|}{\psi(U_{k - 1})} & \multicolumn{1}{c|}{W_{k - 2}} &&\\
		\cline{2-4}
		&\vdots & \vdots & \vdots & \ddots &\\
		\cline{2-6}
		U_1 \left\{\right.&\multicolumn{4}{|c|}{\psi(U_2)} & \multicolumn{1}{c|}{W_1}\\
		\cline{2-6}
	\end{array}\]
	
	Здесь $\forall i \in \{1, \dots, k - 1\}: W_i$ "--- прямое дополнение $\psi(U_{i + 1})$ в $U_i$. Если на каждой <<ступеньке>> $U_i$ выбрать базис $e_i$, то образ этого базиса $\psi(e_i)$ будет базисом в $\psi(U_i)$, который можно будет дополнить до базиса $e_{i - 1}$ в $U_{i - 1}$. Тогда система $e_k \cup \dots \cup e_1$ и будет искомым базисом в $V$, а каждая вертикальная <<цепочка>> вида $\overline{e_j}, \psi(\overline{e_j}), \dots$ будет порождать очередное циклическое подпространство $C_j$, причем сумма $\sum_jC_j$ "--- прямая и равна $V$.
\end{note}

\begin{note}
	Диагональный вид матрицы также является жордановым видом: каждый элемент главной диагонали "--- это жорданова клетка размера 1.
\end{note}

\begin{theorem}[о единственности жордановой нормальной формы]
	Пусть $\phi \in \mathcal{L}(V)$, причем $\Chi_\phi$ имеет вид $\eqref*{charpol}$. Тогда жорданва нормальная форма оператора $\phi$ единственна с точностью до перестановки клеток.
\end{theorem}

\begin{proof}
	Для доказательства покажем, как описать жорданову нормальную форму оператора $\phi$ с помощью инвариантных понятий, связанных с $\phi$. Пусть $\phi \leftrightarrow_e A \in M_n(F)$, где $A$ "--- жорданова нормальная форма, имеющая такой вид, что все клетки, соответствующие собственному значению $\lambda_0$, стоят в начале, и им соответствует начальный фрагмент базиса $(\overline{e_1},\dots,\overline{e_d}) \subset (\overline{e_1},\dots,\overline{e_n})$. Достаточно показать, что набор размеров этих клеток $\{k_1, \dots, k_s\}$ определен однозначно, поскольку для клеток, соответствующих остальным собственным значениям, рассуждения будут аналогичны.
	
	\begin{enumerate}
		\item Восстановим $d$ и $\langle\overline{e_1}, \dots, \overline{e_d}\rangle$. Пусть алгебраическая кратность у $\lambda_0$ равна $\alpha_0$, тогда, поскольку $A$ "--- верхнетреугольная, $d \hm{=} \alpha_0$. Рассмотрим оператор $\phi_{\lambda_0}$ и заметим, что $\phi_{\lambda_0} \leftrightarrow_e A_{\lambda_0} = A -\lambda_0E$, то есть первые $d$ элементов на главной диагонали $A_{\lambda_0}$ нулевые, а все остальные "--- ненулевые.
		
		Заметим, что при возведении $A_{\lambda_0}$ в некоторую степень каждая клетка возводится в степень независимо, и, кроме того, у каждой следующей степени $J_k$ диагональ из единиц <<смещается>> на один вверх относительно предыдущей, поэтому $(J_k)^k = 0$. Значит, при возведении $A_{\lambda_0}$ в степень $d$ клетки, образованные первыми $d$ векторами базиса, гарантированно обнулятся, а остальные клетки, будучи невырожденными в $A_{\lambda_0}$, останутся невырожденными в $(A_{\lambda_0})^d$. Таким образом, $\rk{(A_{\lambda_0})^d} = n - d$, откуда $\dim{V^{\lambda_0}} = \dim{\ke{(\phi_{\lambda_0})^d}} = n - \rk{(A_{\lambda_0})^d} = d$. Кроме того, поскольку $V^{\lambda_0}$ "--- это все векторы, обнуляемые $(\phi_{\lambda_0})^d$, то $\langle\overline{e_1}, \dots, \overline{e_d}\rangle = V^{\lambda_0}$.
		
		\item Исследуем $\psi := \phi_{\lambda_0}|_{V^{\lambda_0}}$. Оператор $\psi$ "--- нильпотентный, причем его матрица в базисе $e' = (\overline{e_1}, \dots, \overline{e_d})$ имеет следующий вид:
		\[\psi \leftrightarrow_{e'} B = \left(\begin{array}{@{}cccc@{}}
			\cline{1-1}
			\multicolumn{1}{|c|}{J_{k_1}} & 0 & \dots & 0\\
			\cline{1-2}
			0 & \multicolumn{1}{|c|}{J_{k_2}} & \dots & 0\\
			\cline{2-2}
			\vdots & \vdots & \ddots & \vdots\\
			\cline{4-4}
			0 & 0 & \dots & \multicolumn{1}{|c|}{J_{k_s}}\\
			\cline{4-4}
		\end{array}\right)\]
		
		Пусть $n_1$ "--- число клеток размера $\ge 1$, $n_2$ "--- число клеток размера $\ge 2$ и т.\:д. Тогда число клеток размера $j$ "--- это $n_j - n_{j + 1}$. Значит, для определения числа клеток каждого размер достаточно найти все $n_i$. Обозначим $\ke{\psi^i}$, то есть пространство векторов высоты $\le i$, через $V_i$, тогда $V_{\lambda_0} \hm{=} V_1 \le V_2 \hm{\le} \dots \hm{\le} V_d = V^{\lambda_0}$. Чтобы определить $\dim{V_1}, \dots, \dim{V_d}$, снова воспользуемся замечанием о том, что возведение клетки $J_k$ в степень $i$ <<смещает>> диагональ из единиц на $i$ позиций вверх:
		\begin{align*}
			\dim{V_1} &= \dim{\ke{\psi}} = d - \rk{B} = n_1\\
			\dim{V_2} &= \dim{\ke{\psi^2}} = (d - \rk{B}) + (\rk{B} - \rk{B^2}) = n_1 + n_2\\
			\dim{V_3} &= \dim{\ke{\psi^3}} = (d - \rk{B^2}) + (\rk{B^2} - \rk{B^3}) = n_1 + n_2 + n_3\\
			&\dots\\
			\dim{V_i} &= \dim{\ke{\psi^i}} = (d - \rk{B^{i - 1}}) + (\rk{B^{i - 1}} - \rk{B^i})= \sum_{j = 1}^in_j
		\end{align*}
		
		Таким образом, все $n_j$ однозначно выражаются через $\dim{V_i}$ вне зависимости от выбора базиса, и по ним однозначно определяется набор $\{k_1, \dots, k_s\}$.
	\end{enumerate}
	
	Нам удалось показать, что жорданова нормальная форма однозначно (с точностью до перестановки клеток) задается свойствами оператора, не зависящими от выбора базиса, что и означает ее единственность.
\end{proof}