\subsection{Ортогональные операторы}

\textbf{В данном разделе} зафиксируем евклидово (эрмитово) пространство $V$.

\begin{definition}
	Оператор $\phi \in \mathcal{L}(V)$ называется \textit{ортогональным} (\textit{унитарным}), если $\forall \overline{u}, \overline{v} \in V: (\phi(\overline{u}), \phi(\overline{v})) = (\overline{u}, \overline{v})$.
\end{definition}

\begin{note}
	Условие в предыдущем определении "--- это равенство двух $\theta$-линейных форм, симметрических в евклидовом случае и эрмитовых "--- в эрмитовом. Они однозначно задаются соответствующими им квадратичными формами, поэтому равенство достаточно проверять лишь при $\overline{u} = \overline{v}$, тогда оно принимает вид $\forall \overline{v} \in V: ||\phi(\overline{v})|| = ||\overline{v}||$.
\end{note}

\begin{proposition}
	Пусть преобразование $\phi: V \rightarrow V$ евклидова пространства $V$ ортогонально, то есть $\forall \overline{u}, \overline{v} \in V: (\phi(\overline{u}), \phi(\overline{v})) = (\overline{u}, \overline{v})$. Тогда $\phi \in \mathcal{L}(V)$.
\end{proposition}

\begin{proof}
	Пусть $\overline{u}, \overline{v} \in V$, $\alpha \in \mathbb{R}$. Пользуясь линейностью скалярного произведения и ортогональностью преобразования $\phi$, получим:
	\begin{gather*}
		||\phi(\overline{u} + \overline{v}) - \phi(\overline{u}) - \phi(\overline{v})||^2 = ||(\overline{u} + \overline{v}) - \overline{u} - \overline{v}||^2 = 0\\
		||\phi(\alpha\overline{u}) -\alpha\phi(\overline{u})||^2 = ||\alpha\overline{u} - \alpha\overline{u}||^2 = 0
	\end{gather*}
	
	Значит, $\phi(\overline{u} + \overline{v}) = \phi(\overline{u}) + \phi(\overline{v})$ и $\phi(\alpha\overline{u}) = \alpha\phi(\overline{u})$. Таким образом, $\phi \in \mathcal{L}(V)$.
\end{proof}

\begin{theorem}
	Пусть $\phi \in \mathcal{L}(V)$. Тогда оператор $\phi$ ортогонален (унитарен) $\hm\Leftrightarrow$ $\phi$ обратим и $\phi^{-1} = \phi^{*}$.
\end{theorem}

\begin{proof}
	По определению, $\phi$ ортогональнен (унитарен) $\hm{\Leftrightarrow}$ для любых векторов $\overline{u}, \overline{v} \in V$ выполнено $(\overline{u}, \overline{v}) = (\phi(\overline{u}), \phi(\overline{v})) = (\overline{u}, (\phi^*\phi)(\overline{v}))$. В силу единственности сопряженного оператора, это равносильно равенству $\phi^*\phi = \id^* = \id$. Это, в свою очередь, равносильно тому, что $\phi$ обратим и $\phi^{-1} \hm{=} \phi^{*}$.
\end{proof}

\begin{note}
	В бесконечномерном случае из того, что $\phi^*\phi = \id$, не следует, что $\phi$ обратим, поэтому тогда в определении ортогонального оператора приходится добавлять, что он обязательно биективен.
\end{note}

\begin{corollary}
	Пусть $\phi \in \mathcal{L}(V)$, $e$ "--- ортонормированный базис в $V$
	\begin{enumerate}
		\item Если $\phi \leftrightarrow_e A$, то оператор $\phi$ ортогонален (унитарен) $\Leftrightarrow$ $\exists A^{-1} = A^*$, то есть $A$ ортогональна (унитарна).
		\item Оператор $\phi$ ортогонален (унитарен) $\Leftrightarrow$ $\phi(e)$ "--- ортонормированный базис.
	\end{enumerate}
\end{corollary}

\begin{proof}~
	\begin{enumerate}
		\item Поскольку $\phi^* \leftrightarrow_e A^*$, то $\exists \phi^{-1} = \phi^* \Leftrightarrow \exists A^{-1} = A^{*}$.
		\item Пусть $\phi \leftrightarrow_e A$, тогда оператор $\phi$ ортогонален (унитарен) $\Leftrightarrow$ матрица $A$ ортогональна (унитарна) $\lra$ $\phi(e) = eA$ "--- ортонормированный базис.\qedhere
	\end{enumerate}
\end{proof}

\begin{corollary}
	Пусть $\phi \in \mathcal{L}(V)$ "--- ортогональный (унитарный). Тогда $|\det\phi| = 1$.
\end{corollary}

\begin{proof}
	Зафиксируем ортонормированный базис $e$ в $V$. Тогда если $\phi \leftrightarrow_e A$, то $AA^* = E$. Значит, $|\det{A}|^2 \hm{=} \det{A}\overline{\det{A}} = \det{A}\det{A^*} = 1 \ra |\det{A}| = 1$.
\end{proof}

\begin{proposition}
	Пусть $\phi\in \mathcal{L}(V)$ "--- ортогональный (унитарный), $U \le V$. Тогда $U$ инвариантно относительно $\phi$ $\Leftrightarrow$ $U^\perp$ инвариантно относительно $\phi$.
\end{proposition}

\begin{proof}
	Поскольку $(U^\perp)^\perp = U$, то достаточно доказать импликацию $\ra$. Так как $U$ инвариантно относительно $\phi$, то $U^\perp$ инвариантно относительно $\phi^* = \phi^{-1}$, то есть $\phi^{-1}(U^\perp) \le U^\perp$. Но оператор $\phi$ биективен, поэтому $\phi^{-1}(U^\perp) = U^\perp$ и $\phi(U^\perp) = U^\perp$, откуда $U^\perp$ инвариантно относительно $\phi$.
\end{proof}

\begin{theorem}
	Пусть $V$ "--- эрмитово пространство, $\phi \in \mathcal{L}(V)$ "--- унитарный. Тогда в $V$ существует ортонормированный базис $e$, в котором матрица оператора $\phi$ диагональна с числами модуля $1$ на главной диагонали.
\end{theorem}

\begin{proof}
	Докажем диагонализуемость оператора $\phi$ в ортонормированном базисе индукцией по $n = \dim{V}$. База, $n = 1$, тривиальна. Пусть теперь $n > 1$. Поскольку у $\chi_\phi$ есть корень над $\Cm$, то у $\phi$ есть собственный вектор $\overline{e_0}$ длины $1$. Тогда $U := \langle\overline{e_0}\rangle^\perp$ инвариантно относительно $\phi$, поэтому можно расмотреть оператор $\phi|_{U} \in \mathcal{L}(V)$, который также является унитарным. По предположению индукции, в $U$ есть ортонормированный базис из собственных векторов, тогда объединение с $\overline{e_0}$ дает искомый базис в $V$.
	
	Покажем теперь, что все собственные значения оператора $\phi$ имеют модуль $1$. Действительно, если $\overline{v} \in V$, $\overline{v} \ne 0$ "--- собственный вектор со значением $\lambda$, то $(\overline{v}, \overline{v}) = (\phi(\overline{v}), \phi(\overline{v})) \hm= |\lambda|^2(\overline{v}, \overline{v}) \Rightarrow |\lambda| = 1$.
\end{proof}

\begin{note}
	Пусть, напротив, $e$ "--- ортонормированный базис в $V$, $\phi \in \mathcal{L}(V)$, и $\phi \leftrightarrow_e A$, где $A$ диагональна с числами модуля 1 на диагонали. Тогда $A^*A = E$, поэтому $\phi$ унитарен.
\end{note}

\begin{proposition}
	Пусть $V$ "--- линейное пространство над $\mathbb{R}$, $\dim{V} \ge 1$, $\phi \in \mathcal{L}(V)$. Тогда у $\phi$ существует одномерное или двумерное инвариантное подпространство.
\end{proposition}

\begin{proof}
	По основной теореме алгебры, минимальный многочлен $\mu_\phi$ имеет следующий вид:
	\[\mu_\phi(x) = \prod_{i = 1}^k(x - \alpha_i)\prod_{j = 1}^m(x^2 + \beta_jx + \gamma_j)\]
	
	Поскольку $\mu_\phi(\phi) = 0$, то хотя бы один из операторов $\phi - \alpha_i$, $\phi^2 + \beta_j\phi + \gamma_j$ "--- вырожденный. Более того, все они вырожденные в силу минимальности многочлена $\mu_\phi$. Значит, возможны два случая:
	\begin{enumerate}
		\item Если $\phi - \alpha$ "--- вырожденный, то $\exists \overline{v} \in V$, $\overline{v} \ne \overline{0}$ "--- собственный вектор с собственным значением $\alpha$, и $\langle\overline{v}\rangle \le V$ "--- искомое подпространство.
		\item Если $\phi^2 + \beta\phi + \gamma$ "--- вырожденный, то $\exists \overline{v} \in V$, $\overline{v} \ne \overline{0}: (\phi^2 + \beta\phi \hm{+} \gamma)(\overline{v}) \hm{=} \overline{0}$. Поскольку $\phi^2(\overline{v}) = -\beta\phi(\overline{v}) - \gamma\overline{v}$, то $\langle\overline{v}, \phi(\overline{v})\rangle \hm{\le} V$ "--- искомое подпространство.\qedhere
	\end{enumerate}
\end{proof}

\begin{theorem}
	Пусть $V$ "--- евклидово пространство, $\phi \in \mathcal{L}(V)$ "--- ортогональный. Тогда в $V$ существует ортонормированный базис $e$, в котором матрица оператора $\phi$ имеет следующий вид:
	\[\phi \leftrightarrow_e A = \left(\begin{array}{@{}cccc@{}}
		\cline{1-1}
		\multicolumn{1}{|c|}{B_1} & 0 & \dots & 0\\
		\cline{1-2}
		0 & \multicolumn{1}{|c|}{B_2} & \dots & 0\\
		\cline{2-2}
		\vdots & \vdots & \ddots & \vdots\\
		\cline{4-4}
		0 & 0 & \dots & \multicolumn{1}{|c|}{B_m}\\
		\cline{4-4}
	\end{array}\right),\]
	
	где $\forall i \in \{1, \dots, m\}: B_i = (\pm1)$ или $B_i = \begin{pmatrix}\cos{\alpha}&-\sin{\alpha}\\
		\sin{\alpha}&\cos{\alpha}\end{pmatrix}$, $\alpha \in [0, 2\pi)$.
\end{theorem}

\begin{proof}
	Проведем индукцию по $n := \dim{V}$. База, $n = 0$, тривиальна. Пусть теперь $n \ge 1$. Выберем $U \hm{\le} V$ "--- одномерное или двумерное инвариантное относительно $\phi$ подпространство. Тогда $U^\perp$ тоже инвариантно относительно $\phi$, и в $U^\perp$ есть требуемый базис $e'$ по предположению индукции. Если $e''$ "--- некоторый ортонормированный базис в $U$, то его объединение с $e'$ дает ортонормированный базис в $V$. Исследуем оператор $\phi|_U$:
	\begin{enumerate}
		\item Если $\dim{U} = 1$, то $U = \langle\overline{v}\rangle$, где $\overline{v} \in V$ "--- собственный вектор длины $1$ с собственным значением $\lambda \in \R$, и $\lambda = \pm1$ аналогично комплексному случаю.
		\item Если $\dim{U} = 2$, то $\phi_U \leftrightarrow_{e''} C = \begin{pmatrix}a&b\\c&d\end{pmatrix}$. Тогда:
		\[C^TC = E \Leftrightarrow \left\{\begin{aligned}
			a^2 + c^2 = 1\\
			b^2 + d^2 = 1\\
			ab + cd = 0
		\end{aligned}\right.\]
		
		Выберем $\alpha, \beta \in [0, 2\pi)$ такие, что  $a = \cos{\alpha}$, $b = -\sin{\beta}$, $c = \sin{\alpha}$, $d = \cos{\beta}$, тогда $\sin{(\alpha - \beta)} = 0$. Значит, либо $\alpha = \beta$, либо $\alpha = \beta \pm \pi$. В первом случае уже получено требуемое, во втором "--- матрица $C$ имеет следующий вид:
		\[C = \begin{pmatrix}\cos{\alpha}&\sin{\alpha}\\\sin{\alpha}&-\cos{\alpha}\end{pmatrix}\]
		
		В этом случае $\chi_C(\lambda) = \lambda^2 - 1$, поэтому $U = \gl\overline{u}, \overline{v}\gr$, где $\overline{u}, \overline{w} \hm{\in} V$ "--- собственные векторы длины $1$ с собственными значениями $1$ и $-1$. Заметим теперь, что $(\overline{u}, \overline{w}) \hm{=} (\phi(\overline{u}), \phi(\overline{w})) \hm= (\overline{u}, -\overline{w}) = -(\overline{u}, \overline{w})$, откуда $(\overline{u}, \overline{w}) = 0$.\qedhere
	\end{enumerate}
\end{proof}

\begin{note}
	Теорема также утверждает, что геометрический смысл ортогонального оператора "--- это композиция отражений и двумерных поворотов.
\end{note}

\begin{note}
	Аналогично комплексному случаю, любой оператор, имеющий в ортонормированном базисе матрицу описанного выше вида, ортогонален.
\end{note}

\begin{note}
	Назовем оператор $\phi \in \mathcal{L}(V)$ \textit{нормальным}, если $\phi^*\phi \hm{=} \phi\phi^*$. Тогда аналогичным рассуждением можно показать, что в эрмитовом пространстве $V$ любой нормальный оператор приводится к диагональному виду в ортонормированном базисе, а также что любой диагонализуемый в ортонормированном базисе оператор нормален.
\end{note}

\begin{theorem}
	Пусть $\phi \in \mathcal{L}(V)$. Тогда существуют $\psi, \Theta \in \mathcal{L}(V)$ такие, что $\psi$ "--- самосопряженный с неотрицательными собственными значениями, $\Theta$ "--- ортогональный (унитарный), и $\phi = \psi\Theta$.
\end{theorem}

\begin{proof}
	Рассмотрим оператор $\eta := \phi^*\phi$, тогда $\eta^* = \phi^*\phi \hm{=} \eta$, то есть $\eta$ "--- самосопряженный. Более того, если $\overline{v} \in V \backslash \{\overline{0}\}$ "--- собственный вектор оператора $\eta$ с собственным значением $\lambda \in \R$, то $\eta(\overline{v}) = \lambda\overline{v}$, тогда $0 \le (\phi(\overline{v}), \phi(\overline{v})) = (\overline{v}, \eta(\overline{v})) = \lambda(\overline{v}, \overline{v}) \Rightarrow \lambda \ge 0$.
	
	Пусть $(\overline{e_1}, \dots, \overline{e_n})$ "--- ортонормированный базис в $V$ из собственных векторов оператора $\eta$ с собственными значениями $\lambda_1, \dotsc, \lambda_n \ge 0$. Положим $\overline{f_i} := \phi(\overline{e_i})$, $i \in \{1, \dotsc, n\}$. Тогда для любых $i, j \in \{1, \dots, n\}$ выполнено $(\overline{f_i}, \overline{f_j}) = (\phi(\overline{e_i}), \phi(\overline{e_j})) = (\overline{e_i}, \eta(\overline{e_j})) = \lambda_j(\overline{e_i}, \overline{e_j})$. Значит, система $(\overline{f_1}, \dots, \overline{f_n})$ ортогональна, и, более того, для любого $i \in \{1, \dotsc, n\}$ выполнено $||\overline{f_i}||^2 = \lambda_i||\overline{e_i}||^2 = \lambda_i$.
	
	Будем без ограничения общности считать, что $\lambda_1, \dots, \lambda_k > 0$ и $\lambda_{k + 1} = \dots = \lambda_n = 0$. Положим $\overline{g_i} := \frac{1}{\sqrt{\lambda_i}}\overline{f_i}$, $i \in \{1, \dots, k\}$, и дополним $(\overline{g_1}, \dots, \overline{g_k})$ до ортонормированного базиса $(\overline{g_1}, \dots, \overline{g_n})$. Тогда оператор $\phi$ имеет следующий вид:
	$\overline{e_i} \mapsto \overline{g_i} \mapsto \sqrt{\lambda_{i}}\overline{g_i} = \overline{f_i}$. Зададим $\psi, \Theta \in \mathcal{L}(V)$ на базисах $(\overline{e_1}, \dots, \overline{e_n})$ и $(\overline{g_1}, \dots, \overline{g_n})$ следующим образом:
	\begin{align*}
		\Theta&: \overline{e_i} \mapsto \overline{g_i}\\
		\psi&: \overline{g_i} \mapsto \sqrt{\lambda_{i}}\overline{g_i} = \overline{f_i}
	\end{align*}
	
	Таким образом, $\psi\Theta = \phi$. Наконец, $\Theta$ переводит ортонормированный базис $(\overline{e_1}, \dots, \overline{e_n})$ в ортонормированный базис $(\overline{g_1}, \dots, \overline{g_n})$, поэтому $\Theta$ "--- ортогональный (унитарный), а $\psi$ имеет в ортонормированном базисе $(\overline{g_1}, \dots, \overline{g_n})$ диагональный вид, поэтому $\psi$ "--- самосопряженный.
\end{proof}

\begin{note}
	Порядок операторов в композиции несущественен: если $\phi = \psi\Theta$, то $\phi^* \hm= \Theta^*\psi^* = \Theta^{-1}\psi$ "--- теперь ортогональный (унитарный) оператор $\Theta^{-1}$ идет перед самосопряженным оператором $\psi$.
\end{note}

\begin{definition}
	Представление $\phi \in \mathcal{L}(V)$ в виде $\psi\Theta$ (или в виде $\Theta'\psi'$) с соответствующими требованиями из теоремы выше называется \textit{полярным разложением} $\phi$, а базисы $(\overline{e_1}, \dots, \overline{e_n})$ и $(\overline{g_1}, \dots, \overline{g_n})$ из доказательства теоремы "--- \textit{сингулярными базисами} $\phi$, причем эти базисы одинаковы в случаях $\psi\Theta$ и $\Theta'\psi'$.
\end{definition}

\begin{note}
	Геометрический смысл полярного разложения "--- представление оператора $\phi$ в виде композиции движения $\Theta$ и растяжения $\psi$ (с неотрицательными коэффициентами) вдоль нескольких взаимно ортогональных осей.
\end{note}

\begin{note}
	Можно показать, что если оператор $\phi \in \mathcal{L}(V)$ "--- невырожденный, то полярное разложение $\phi$ единственно.
\end{note}