\begin{corollary}
	Любой действительный многочлен степени $n \ge 1$ может быть разложен на множители следующим образом:
	
	Если $p(z)$ имеет вид:
	\[
		p(z) = cz^n + \ldots
	\]
	то существуют числа $a_1, \ldots, a_r \in \R\ (0 \le r \le n)$, $p_1, \ldots, p_s, q_1, \ldots, q_s \in \R\ (0 \le s \le n)$ и числа $\alpha_1 \ldots, \alpha_r, \beta_1 \ldots \beta_s \in \N$ такие, что
	\begin{enumerate}
		\item \[
			\forall j \in \range{s}\ p_j^2 - 4q_j < 0
		\]
		
		\item \[
			\suml_{i = 1}^r \alpha_i + 2\suml_{j = 1}^s \beta_j = n
		\]
		
		\item \[
			p(x) = c \cdot \prodl_{i = 1}^r (x - a_i)^{\alpha_i} \cdot \prodl_{j = 1}^s (x^2 + p_j x + q_j)^{\beta_j}
		\]
	\end{enumerate}
\end{corollary}

\begin{proof}
	По индукции через теорему Безу и основную теорему алгебры. Пусть есть многочлен $p(x)$. Тогда, если он обладает действительным корнем, распишем его как
	\[
		p(x) = (x - a)p_1(x)
	\]
	и применим предположение индукции. Если же корень $z_0$ - комплексный, то тогда и его сопряжение будет корнем. Значит, многочлен можно представить как
	\[
		p(x) = (x - z_0)(x - \bar{z}_0)p_1(x) = (x^2 - 2x\re z_0 + |z_0|^2)p_1(x)
	\]
	Отсюда $p_j = 2\re z_0$, а $q_j = |z_0|^2$. Если мы посмотрим на $p^2_j - 4q_j$, то увидим, что
	\[
		p^2_j - 4q_j = 4(\re z_0)^2 - 4|z_0|^2 = -4(\im z_0)^2 < 0
	\]
\end{proof}

\begin{definition}
	\textit{Правильной рациональной дробью (функцией)} называется $\frac{P(x)}{Q(x)}$, где $P(x), Q(x)$ - многочлены такие, что $\Deg P < \Deg Q$
\end{definition}

\begin{lemma}
	Пусть $\frac{P(x)}{Q(x)}$ - правильная действительная рациональная функция, причём $a \in \R$ - нуль многочлена $Q(x)$ порядка $\alpha$, то есть $Q(x)$ представим в виде:
	\[
		Q(x) = (x - a)^\alpha Q_1(x),\ Q_1(a) \neq 0
	\]
	Тогда существует число $A \in \R$ такое, что
	\[
		\frac{P(x)}{Q(x)} = \frac{A}{(x - a)^\alpha} + \frac{P_1(x)}{(x - a)^{\alpha - 1} Q_1(x)}
	\]
	где второе слагаемое - тоже правильная рациональная дробь.
\end{lemma}

\begin{proof}
	Рассмотрим разность \(\frac{P(x)}{Q(x)} - \frac{A}{(x - a)^\alpha}\) с пока произвольным $A \in \R$:
	\[
		\frac{P(x)}{Q(x)} - \frac{A}{(x - a)^\alpha} = \frac{P(x) - AQ_1(x)}{Q(x)}
	\]
	Потребуем $A$ такое, что при $x = a$ числитель дроби обнуляется:
	\[
		P(a) - AQ_1(a) = 0 \Ra A = \frac{P(a)}{Q_1(a)}
	\]
	Раз теперь сверху записан многочлен, у которого $x = a$ - это корень, то дробь можно расписать как
	\[
		\frac{P(x) - AQ_1(x)}{Q(x)} = \frac{(x - a)P_1(x)}{(x - a)^\alpha Q_1(x)}
	\]
	Так и получили разложение $\frac{P(x)}{Q(x)}$.
\end{proof}

\begin{lemma}
	Пусть $\frac{P(x)}{Q(x)}$ - правильная действительная рациональная функция, причём $z_0 \in \Cm \bs \R$ - нуль $Q(x)$ порядка $\beta$. Тогда существуют $B, C \in \R$ такие, что
	\[
		\frac{P(x)}{Q(x)} = \frac{Bx + C}{(x^2 + px + q)^\beta} + \frac{P_1(x)}{(x^2 + px + q)^{\beta - 1} Q_1(x)}
	\]
	где второе слагаемое - правильная рациональная дробь, $(x - z_0)(x - \bar{z}_0) = x^2 + px + q$, а также $Q(x) = (x^2 + px + q)^\beta Q_1(x)$
\end{lemma}

\begin{proof}
	Аналогично предыдущему доказательству, рассмотрим разность при произвольных $B, C \in \R$:
	\[
		\frac{P(x)}{Q(x)} - \frac{Bx + C}{(x^2 + px + q)^\beta} = \frac{P(x) - (Bx + C)Q_1(x)}{Q(x)}
	\]
	Выберем $B, C \in \R$ так, чтобы числитель обнулился в точке $z_0$:
	\[
		P(z_0) - (Bz_0 + C)Q_1(z_0) = 0
	\]
	Разложим $z_0$ на действительную и мнимую части $z_0 = x_0 + y_0 i$ и разделим их в равенстве:
	\[
		P(x_0 + y_0 i) - (Bx_0 + C)Q_1(z_0) - By_0 Q_1(z_0) i = 0
	\]
	То есть
	\[
		\frac{P(z_0)}{Q_1(z_0)} = Bx_0 + C + By_0 i
	\]
	Отсюда можно однозначно получить $B$ и $C$ как
	\begin{align*}
		&{B = \im \frac{P(z_0)}{y_0 Q_1(z_0)}}
		\\
		&{C = \re \left(\frac{P(z_0)}{Q_1(z_0)} - Bz_0\right)}
	\end{align*}
	Это означает, что мы снова можем выделить сомножитель $(x^2 + px + q)$ в числителе и получить нужное разложение для $\frac{P(x)}{Q(x)}$.
\end{proof}

\begin{theorem}
	Каждая действительная рациональная функция имеет первообразную, выражающуюся в элементарных функциях.
\end{theorem}

\begin{proof}
	Пусть $\frac{P(x)}{Q(x)}$ - действительная рациональная функция. Тогда по уже доказанной лемме, её можно записать в виде
	\[
		\frac{P(x)}{Q(x)} = M(x) + \frac{R(x)}{Q(x)}
	\]
	где $\frac{R(x)}{Q(x)}$ - уже правильная действительная рациональная функция. Разложим $Q(x)$ на множители, согласно следствию основной теоремы алгебры:
	\[
		Q(x) = c \prodl_{i = 1}^r (x - a_i)^{\alpha_i} \cdot \prodl_{j = 1}^s (x^2 + p_j x + q_j)^{\beta_j}
	\]
	Последовательно применяя доказанные леммы о разложении дроби, получим выражение:
	\[
		\frac{R(x)}{Q(x)} = \frac{1}{c} \left(\suml_{i = 1}^r \suml_{k = 0}^{\alpha_i - 1} \frac{A_{ik}}{(x - a_i)^{\alpha_i - k}} + \suml_{j = 1}^s \suml_{k = 0}^{\beta_j - 1} \frac{B_{jk} x + C_{jk}}{(x^2 + p_j x + q_j)^{\beta_j - k}}\right)
	\]
	В силу линейности интеграла, чтобы получить его функцию от $\frac{P(x)}{Q(x)}$, нам нужно отдельно взять интеграл от $M(x)$ и от каждого слагаемого в разложении $\frac{R(x)}{Q(x)}$:
	\begin{align*}
		&{\int \frac{A}{(x - a)^\alpha} dx = A\int \frac{dt}{t^\alpha} = \text{ один из двух табличных}}
		\\
		&{\int \frac{Bx + C}{(x^2 + px + q)^\beta} dx = \int \frac{\frac{B}{2}(2x + p)}{(x^2 + px + q)^\beta} dx + \left(C - \frac{Bp}{2}\right) \int \frac{dx}{(x^2 + px + q)^\beta}}
	\end{align*}
	Первое слагаемое интегрируется через замену переменной, второе - рекуррентный интеграл. 
\end{proof}

\begin{theorem} (Теорема Абеля, 1826г.)
	Пусть $R(x)$ - многочлен степени $2g + 2$ без кратных корней такой, что уравнение Пелля $P^2(x) - Q^2(x)R(x) = 1$ имеет решение в многочленах $P, Q \neq 0$. Тогда существует многочлен $q(x)$ степени $g$ такой, что $\int \frac{q(x)dx}{\sqrt{R(x)}}$ выражается в элементарных функциях. Причём
	\[
		\int \frac{q(x)dx}{\sqrt{R(x)}} = \frac{1}{2}\ln \frac{P + Q\sqrt{R}}{P - Q\sqrt{R}} + C,\ C \in \R
	\]
\end{theorem}

\begin{proof}
	Для доказательства посмотрим на производную от выражения:
	\begin{multline*}
		\frac{d}{dx}\left(\frac{1}{2}\ln \frac{P + Q\sqrt{R}}{P - Q\sqrt{R}}\right) =
		\\
		\frac{1}{2} \cdot \frac{P - Q\sqrt{R}}{P + Q\sqrt{R}} \cdot \frac{\left(P' + Q'\sqrt{R} + \frac{QR'}{2\sqrt{R}}\right)(P - Q\sqrt{R}) - (P + Q\sqrt{R})\left(P' - Q'\sqrt{R} - \frac{QR'}{2\sqrt{R}}\right)}{(P - Q\sqrt{R})^2} =
		\\
		\frac{4PQ'R + 2PQR' - 4P'QR}{4\sqrt{R}} = \frac{2R(PQ' - P'Q) + PQR'}{2\sqrt{R}}
	\end{multline*}
	По условию у нас есть тождество
	\[
		P^2 - Q^2 R = 1
	\]
	Продифференцируем его с обеих сторон:
	\[
		2PP' - 2QQ'R - Q^2R' = 0 \Ra 2PP' = Q(2Q'R + QR')
	\]
	Раз $P$ не делится на $Q$, то $P'$ должно делиться на $Q$. Отсюда получаем, что
	\[
		P' = Qq
	\]
	Где $q$ - это какой-то многочлен. При этом
	\[
		\Deg q = \Deg P' - \Deg Q = (2g + 1) - (g + 1) = g
	\]
	Ещё немного преобразуем производную:
	\[
		\frac{2R(PQ' - P'Q) + PQR'}{2\sqrt{R}} = \frac{P(2Q'R + QR') - 2RP'Q}{2\sqrt{R}} = \frac{2P^2P' - 2RP'Q^2}{2Q\sqrt{R}} = \frac{q(x)}{\sqrt{R(x)}}
	\]
	Что и требовалось доказать.
\end{proof}

\begin{note}
	Если положить $R(x) = x^2 - 1$, то уравнение Пелля примет вид:
	\[
		T^2_n(x) - U^2_{n - 1}(x) (x^2 - 1) = 1
	\]
	Решениями этого уравнения являются \textit{многочлены Чебышёва первого и второго рода} соответственно:
	\begin{align*}
		&{T_n(x) = \cos(n \arccos x)}
		\\
		&{U_{n - 1}(x) = \frac{\sin(n \arccos x)}{\sqrt{1 - x^2}}}
	\end{align*}
	Данные выражения действительно являются многочленами, просто записанными в тригонометрической форме. Чтобы их развернуть, необходимо воспользоваться формулой Муавра.
\end{note}