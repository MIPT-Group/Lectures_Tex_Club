\begin{definition}
	Множество всех первообразных функций $f(x)$ называется её \textit{неопределённым интегралом}. Обозначается как
	\[
		\int f(x)dx
	\]
	Ещё корректна следующая запись. Если $F(x)$ - первообразная $f(x)$:
	\[
	 	\int f(x)dx = F(x) + C,\ C \in \R
	\]
\end{definition}

\begin{corollary} (Из теоремы \ref{commonViewTheorem})
	\[
		d\left(\int f(x)dx\right) = f(x)dx
	\]
	Если сама $F(x)$ дифференцируема, то
	\[
		\int d\left(F(x) + C\right) = F(x) + C
	\]
\end{corollary}

\begin{theorem} (Линейность неопределённого интеграла)
	Если $f_1, f_2$ имеют первообразные и выбраны $\alpha_1, \alpha_2 \in \R$, то
	\[
		\int(\alpha_1 f_1 + \alpha_2 f_2)(x)dx = \alpha_1\int f_1(x)dx + \alpha_2 \int f_2(x)dx + C
	\]
\end{theorem}

\begin{note}
	Константа в записи важна, так как если $\alpha_1 = \alpha_2 = 0$, то интегралом от 0 будет константа.
\end{note}

\begin{proof}
	Если $F_1, F_2$ - первообразные $f_1$ и $f_2$ соответственно, то
	\begin{align*}
		F'_1 = f_1
		\\
		F'_2 = f_2
	\end{align*}
	Тогда получается, что
	\[
		\left(\alpha_1 F_1 + \alpha_2 F_2\right)' = \alpha_1 f_1 + \alpha_2 f_2
	\]
	То есть линейная комбинация $F_1$ и $F_2$ - первообразная для линейной комбинации $f_1$ и $f_2$.
\end{proof}

\begin{theorem} (Замена переменных или метод подстановки)
	Если $F$ - первообразная функции $f$ на промежутке $\goth{J}$ и функция $\phi: I \to \goth{J}$ дифференцируема на промежутке $I$, то
	\[
		\int f(\phi(t))\phi'(t)dt = F(\phi(t)) + C
	\]
\end{theorem}

\begin{proof}
	Просто посчитаем производную $F(\phi(t))$:
	\[
		\left(F(\phi(t))\right)' = F'(\phi(t)) \cdot \phi'(t) = f(\phi(t)) \cdot \phi'(t)
	\]
\end{proof}

\begin{theorem} (Формула интегрирования по частям)
	Если $u, v$ дифференцируемы на промежутке $I$, функция $uv'$ имеет первообразную на $I$, то $u'v$ также имеет первообразную на $I$, причём
	\[
		\int u'(x)v(x)dx = u(x)v(x) - \int u(x)v'(x)dx
	\]
\end{theorem}

\begin{proof}
	Пусть $F(x)$ - первообразная для $uv'(x)$. Тогда, распишем производную $uv$:
	\[
		\left(u(x)v(x)\right)' = u'(x)v(x) + u(x)v'(x) = u'(x)v(x) + F'(x)
	\]
	Отсюда получаем, что
	\[
		(u(x)v(x) - F(x))' = u'(x)v(x)
	\]
	То есть нашли первообразную для $u'(x)v(x)$.
\end{proof}

\begin{note}
	Более кратко формулу интегрирования по частям можно записать так:
	\[
		\int udv = uv - \int vdu
	\]
\end{note}

\subsubsection*{Таблица неопределённых интегралов}

\begin{enumerate}
	\item \[
		\int x^a dx = \frac{x^{a + 1}}{a + 1} + C,\ a \neq -1
	\]
	
	\item \[
		\int \frac{dx}{x} = \ln |x| + C
	\]
	
	\item \[
		\int a^x dx = \frac{a^x}{\ln a} + C,\ a > 0, a \neq 1
	\]
	
	\item \[
		\int \sin x dx = -\cos x + C
	\]
	
	\item \[
		\int \cos x dx = \sin x + C
	\]
	
	\item \[
		\int \frac{dx}{\cos^2 x} = \tg x + C
	\]
	
	\item \[
		\int \frac{dx}{\sin^2 x} = -\ctg x + C
	\]
	
	\item \[
		\int \sh x dx = \ch x + C
	\]
	
	\item \[
		\int \ch x dx = \sh x + C
	\]
	
	\item \[
		\int \frac{dx}{\ch^2 x} = \th x + C
	\]
	
	\item \[
		\int \frac{dx}{\sh^2 x} = -\cth x + C
	\]
	
	\item \[
		\int \frac{dx}{x^2 + 1} = \arctg x + C\ (-\arcctg x + C)
	\]
	
	\item \[
		\int \frac{dx}{\sqrt{1 - x^2}} = \arcsin x + C\ (-\arccos x + C)
	\]
	
	\item \[
		\int \frac{dx}{x^2 - 1} = \frac{1}{2}\ln \left|\frac{x - 1}{x + 1}\right| + C
	\]
	
	\item \[
		\int \frac{dx}{\sqrt{x^2 \pm 1}} = \ln |x + \sqrt{x^2 \pm 1}| + C
	\]
\end{enumerate}

\begin{proof}
	Просто продифференцировать правые части и сравнить с функцией под знаком интеграла.
\end{proof}

\begin{lemma} (Рекуррентный интеграл)
	Если положить за $\goth{J}_n$ интеграл от алгебраической дроби с всегда ненулевым знаменателем:
	\[
		\goth{J}_n = \int \frac{dx}{(x^2 + px + q)^n},\ p^2 - 4q < 0
	\]
	то верно соотношение:
	\[
		\goth{J}_{n + 1} = \frac{2 - 4n}{n(p^2 - 4q)}\goth{J}_n - \frac{2x + p}{n(x^2 + px + q)^n(p^2 - 4q)}
	\]
	При этом
	\[
		\goth{J}_1 = \int \frac{dx}{x^2 + px + q} = \frac{1}{\sqrt{q - \frac{p^2}{4}}} \arctg \frac{x + \frac{p}{2}}{\sqrt{q - \frac{p^2}{4}}} + C
	\]
\end{lemma}

\begin{proof}
	Воспользуемся интегрированием по частям. Сопоставим функции из формулы с тем, что мы имеем:
	\begin{align*}
		&{u = \frac{1}{(x^2 + px + q)^n}}
		\\
		&{du = -\frac{n(2x + p)}{(x^2 + px + q)^{n + 1}}}
		\\
		&{v = x}
		\\
		&{dv = dx}
	\end{align*}
	В итоге получаем:
	\begin{multline*}
		\goth{J}_n = \int \frac{dx}{(x^2 + px + q)^n} = \frac{x}{(x^2 + px + q)^n} + n\int \frac{2x^2 + px}{(x^2 + px + q)^{n + 1}}dx =
		\\
		\frac{x}{(x^2 + px + q)^n} + 2n\int \frac{x^2 + px + q}{(x^2 + px + q)^{n + 1}}dx - n\int \frac{px + 2q}{(x^2 + px + q)^{n + 1}} =
		\\
		\frac{x}{(x^2 + px + q)^n} + 2n\goth{J}_n - \frac{np}{2}\int \frac{2x + p}{(x^2 + px + q)^{n + 1}}dx + n\left(\frac{p^2}{2} - 2q\right) \goth{J}_{n + 1}
	\end{multline*}
	В оставшемся интеграле мы хотим воспользоваться формулой для интеграла сложной функции. Обозначим за $y = x^2 + px + q$, тогда $dy = (2x + p)dx$, что совпадает с нашей формулой. Таким образом, мы приходим к равенству
	\[
		\goth{J}_n = \frac{x}{(x^2 + px + q)^n} + 2n\goth{J}_n - \frac{np}{2}\int \frac{dy}{y^{n + 1}} + \frac{n}{2}(p^2 - 4q)\goth{J}_{n + 1}
	\]
	Получаем рекуррентное соотношение:
	\[
		\goth{J}_{n + 1} = \frac{2 - 4n}{n(p^2 - 4q)}\goth{J}_n - \frac{2x + p}{n(x^2 + px + q)^n(p^2 - 4q)}
	\]
	Остаётся вычислить $\goth{J}_1$:
	\begin{multline*}
		\goth{J}_1 = \int \frac{dx}{x^2 + px + q} = \int \frac{dx}{\left(x + \frac{p}{2}\right)^2 + q - \frac{p^2}{4}} = \frac{1}{q - \frac{p^2}{4}} \int \frac{dx}{\left(\frac{\dse x + \frac{p}{2}}{\dse \sqrt{q - \frac{p^2}{4}}}\right)^2 + 1} =
		\\
		\frac{1}{\sqrt{q - \frac{p^2}{4}}} \arctg \frac{x + \frac{p}{2}}{\sqrt{q - \frac{p^2}{4}}} + C
	\end{multline*}
\end{proof}

\subsection{Интегрирование рациональных функций}

\begin{lemma}
	Пусть $P(x), Q(x)$ - многочлены степеней $m \ge n \ge 1$ соответственно, тогда существуют многочлены $M(x), R(x)$ степеней $m - n$ и $< n$ соответственно, такие, что
	\[
		P(x) = M(x)Q(x) + R(x)
	\]
\end{lemma}

\begin{proof}
	Проведём индукцию по $m$.
	\begin{itemize}
		\item База $m = n$: $P(x)$ и $Q(x)$ имеют виды
		\begin{align*}
			&{P(x) = a_0 x^m + a_1 x^{m - 1} + \ldots + a_m,\ a_0 \neq 0}
			\\
			&{Q(x) = b_0 x^n + b_1 x^{n - 1} + \ldots + b_n,\ b_0 \neq 0}
		\end{align*}
		Положим $M(x) := \frac{a_0}{b_0}$. Тогда 
		\[
			R(x) := P(x) - \frac{a_0}{b_0}Q(x)
		\]
		Понятно, что данные многочлены удовлетворяют предположению индукции. Значит, база верна
		
		\item Переход. Будем считать, что мы доказали всё для $n \le m \le k$ и теперь доказываем $m = k + 1$: аналогично базе рассмотрим многочлен
		\[
			P_1(x) := P(x) - \frac{a_0}{b_0}x^{k + 1 - n} Q(x)
		\]
		Из определения $P_1(x)$ следует, что
		\[
			\Deg P_1 \le k
		\]
		\begin{enumerate}
			\item $\Deg P_1 \in [n; k]$. Тогда применим предположение индукции. Значит
			\begin{align*}
				&{\exists M_1(x) \such \Deg M_1 = \Deg P_1 - n}
				\\
				&{\exists R_1(x) \such \Deg R_1 < n}
			\end{align*}
			При этом
			\[
				P_1(x) = M_1(x)Q(x) + R_1(x)
			\]
			Тогда, чтобы получить нужное представление, достаточно положить за $M(x)$ и $R(x)$ следующие многочлены:
			\begin{align*}
				&{M(x) := \frac{a_0}{b_0}x^{k + 1 - n} + M_1(x)}
				\\
				&{R(x) := R_1(x)}
			\end{align*}
			
			\item $\Deg P_1 < n$. Тогда сразу
			\begin{align*}
			&{M(x) := \frac{a_0}{b_0}x^{k + 1 - n}}
			\\
			&{R(x) := P_1(x)}
			\end{align*}
		\end{enumerate}
	\end{itemize}
\end{proof}

\begin{theorem} (Теорема Безу)
	Если $P(z)$ - многочлен степени $n$, $P(z_0) = 0,\ z_o \in \Cm$, то найдётся многочлен $Q(z)$ степени $n - 1$ такой, что
	\[
		P(z) = (z - z_0)Q(z)
	\]
\end{theorem}

\begin{proof}
	Применим доказанную лемму к $P(z)$ и $(z - z_0)$. Тогда $\exists Q(z)$ степени $n - 1$ и $R(z)$ степени $< 1$ такие, что
	\[
		P(z) = (z - z_0)Q(z) + R(z)
	\]
	Если подставить в это выражение $z = z_0$, то получится, что $R(z_0) = 0$. Так как $R(z)$ - не более чем константа, то $R(z) = 0$ и следовательно
	\[
		P(z) = (z - z_0)Q(z)
	\]
\end{proof}

\begin{lemma}
	Если $P(x)$ - многочлен с действительными коэффициентами, $P(z_0) = 0$, где $\Im z_0 \neq 0$, то $\bar{z_0}$ - также корень многочлена $P(x)$
\end{lemma}

\begin{proof}
	Многочлен $P(x)$ можно записать в виде
	\[
		P(z) = (z - z_0)Q(z)
	\]
	Возьмём комплексное сопряжение от обеих частей равенства:
	\[
		\overline{P(z)} = (\bar{z} - \bar{z}_0) \cdot \overline{Q(z)}
	\]
	Справа у многочлена действительные коэффициенты. Значит $\overline{P(z)} = P(\bar{z})$. При подстановке получаем
	\[
		P(\bar{z}) = (\bar{z} - \bar{z}_0) \cdot \bar{Q}(\bar{z})
	\]
	Если обозначить $w := \bar{z}$, то мы получили равенство
	\[
		P(w) = (w - \bar{z}_0)\bar{Q}(w)
	\]
	Это подтверждает, что $\bar{z}_0$ - нуль исходного многочлена.
\end{proof}

\begin{theorem} (Основная теорема алгебры)
	Всякий многочлен $P(z)$ степени $\ge 1$ имеет хотя бы один корень (нуль) $z_0 \in \Cm$.
\end{theorem}

\begin{note}
	Формально мы не доказывали свойств непрерывных функций в $\Cm^n$, однако они точно такие же, как и для доказанных в $\R^n$. Этим мы и будем пользоваться
\end{note}

\begin{proof}
	От противного. Предположим, что существует многочлен $P(z)$ степени $n \ge 1$ такой, что
	\[
		\forall z \in \Cm\ \ P(z) \neq 0
	\]
	Мы хотим доказать, что
	\[
		\liml_{z \to \infty} P(z) = \infty
	\]
	Но при этом не вводился предел для комплексных чисел. Не стоит бояться, ведь он записывается абсолютно аналогично:
	\[
		\forall \eps > 0\ \exists \delta > 0 \such \forall z,\ |z| > \frac{1}{\delta}\ \ |P(z)| > \frac{1}{\eps}
	\]
	Пусть $P(z)$ имеет вид:
	\[
		P(z) = a_0 z^n + a_1 z^{n - 1} + \ldots + a_n,\ a_0 \neq 0
	\]
	Тогда модуль $P(z)$ можно записать так:
	\[
		|P(z)| = |a_0| \cdot |z|^n \cdot \left|1 + \frac{a_1}{a_0 z} + \ldots + \frac{a_n}{a_0 z^n}\right|
	\]
	Теперь заметим, что
	\[
		\liml_{z \to \infty} \frac{c}{z} = 0 \lra \forall \eps > 0\ \exists \delta > 0 \such \forall z,\ |z| > \frac{1}{\delta}\ \ \left|\frac{c}{z}\right| < \eps
	\]
	Из этого по неравенству треугольника получаем
	\[
		\left|1 + \frac{a_1}{a_0 z} + \ldots + \frac{a_n}{a_0 z^n}\right| \ge 1 - \left(\left|\frac{a_1}{a_0 z}\right| + \ldots + \left|\frac{a_n}{a_0 z^n}\right|\right) \xrightarrow[z \to \infty]{} 1
	\]
	Значит, $\left|1 + \frac{a_1}{a_0 z} + \ldots + \frac{a_n}{a_0 z^n}\right|$ отделён от нуля в окрестности бесконечности. Тогда действительно верно, что
	\[
		\liml_{z \to \infty} P(z) = \infty
	\]
	
	Обозначим за $\eta$ нижнюю грань значений $P(z)$:
	\[
		\eta := \inf\limits_{z \in \Cm} |P(z)| \ge 0
	\]
	В силу неограниченности $P(z)$ мы получаем, что
	\[
		\exists R \such \forall z,\ |z| > R\ \ |P(z)| > \eta + 1
	\]
	Значит $\inf\limits_{z \in \Cm} |P(z)| = \inf\limits_{|z| \le R} |P(z)|$. При этом $P(z)$ - непрерывная функция, так как $\forall n \in \N\ z^n$ - тоже непрерывная функция. Стало быть, у нас есть ограниченная функция на множестве $|z| \le R \Ra $ $P(z)$ достигает своего минимума на нём по теореме Вейерштрасса: 
	\[
		\inf\limits_{|z| \le R} |P(z)| = \min\limits_{|z| \le R} |P(z)| = |P(z_0)| \neq 0
	\]
	Теперь мы знаем, что $\eta$ не просто неотрицательна, она строго положительна. Отнормируем наш многочлен $P(z)$ так, что $\eta' = 1$ и при этом точка, где достигается этот минимум, была нулём:
	\[
		P_1(z) := \frac{P(z + z_0)}{P(z_0)}
	\]
	Несложно проверить, что этот многочлен ровно тот, что нам нужен. Если его расписать, то он будет иметь вид:
	\[
		P_1(z) = 1 + b_k z^k + \ldots + b_n z^n,\ b_n \neq 0, b_k \neq 0,\ 0 < k \le n 
	\]
	где $k$, понятно, индекс первого ненулевого коэффициента. Очередная нормировка будет состоять в том, что мы хотим сделать $b'_k = -1$. Для этого возьмём комплексный корень $c$ степени $k$ из числа $-\frac{1}{b_k}$ и посмотрим на значение $P_1(cz)$:
	\[
		Q(z) := P_1(cz) = 1 - z^k + \ldots + c_n z^n,\ c_n \neq 0
	\]
	При этом $\forall z \in \Cm\ \ |Q(z)| = |P_1(cz)| \ge 1$. Рассмотрим предел
	\[
		\liml_{z \to 0} \frac{c_{k + 1} z^{k + 1} + \ldots + c_n z^n}{z^k} = 0
	\]
	В силу предела существует окрестность $\delta \in (0; 1)$ такая, что
	\[
		\exists \delta \in (0; 1) \such \forall z,\ |z| = \delta\ \ \left|c_{k + 1}z^{k + 1} + \ldots + c_n z^n\right| < \frac{1}{2}|z^k| = \frac{1}{2}\delta^k
	\]
	Теперь оценим $|Q(\delta)|$:
	\[
		|Q(\delta)| \le |1 - \delta^k| + |c_{k + 1}\delta^{k + 1} + \ldots + c_n \delta^n| < 1 - \delta^k + \frac{1}{2}\delta^k = 1 - \frac{1}{2}\delta^k < 1
	\]
	Получили противоречие с тем, что $\forall z \in \Cm\ \ |Q(z)| \ge 1$.
\end{proof}