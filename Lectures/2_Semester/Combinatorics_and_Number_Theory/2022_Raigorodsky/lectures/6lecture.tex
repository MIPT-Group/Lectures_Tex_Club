\subsection{Диофантовы приближения}

\begin{note}
	В этом параграфе натуральные числа считаются от единицы, если не указано
\end{note}

Диофантовы приближения - это область математики, которая изучает приближение иррациональных чисел при помощи рациональных. Более точно, то для числа $\alpha \in \iR$ мы исследуем дроби $p/q$ и функции $\psi \colon \N \to \N$ такие, что выполнено неравенство
\[
	\left|\alpha - \frac{p}{q}\right| < \frac{1}{\psi(q)}
\]

\begin{theorem} (Дирихле)
	Для $\forall \alpha \in \iR$ существует последовательность рациональных дробей $\frac{p}{q}$ таких, что
	\begin{enumerate}
		\item \(\dse \left|\alpha - \frac{p_i}{q_i}\right| < \frac{1}{q_i^2}\)
		
		\item \(\dse \left|\alpha - \frac{p_{i + 1}}{q_{i + 1}}\right| < \left|\alpha - \frac{p_i}{q_i}\right|\)
	\end{enumerate}
\end{theorem}

\begin{proof}~
	\begin{enumerate}
		\item Зафиксируем число $Q \in \N$. Разобьём отрезок $[0; 1]$ на $Q$ отрезков, то есть длина каждого - $1 / Q$. Рассмотрим \textbf{дробные доли} $\{\alpha x\}$ при $x \in \{0, \ldots, Q\}$. По принципу Дирихле
		\[
			\exists x_1, x_2 \colon x_1 > x_2,\ |\{\alpha x_1\} - \{\alpha x_2\}| \le \frac{1}{Q}
		\]
		Распишем дробные части через целые:
		\[
			|\alpha x_1 - [\alpha x_1] - \alpha x_2 + [\alpha x_2]| \le \frac{1}{Q}
		\]
		Перепишем модуль в несколько ином виде:
		\[
			|\alpha(x_1 - x_2) - ([\alpha x_1] - [\alpha x_2])| \le \frac{1}{Q}
		\]
		Теперь обозначим $q := x_1 - x_2 \le Q,\ p := [\alpha x_1] - [\alpha x_2]$. В новых обозначениях неравенство принимает вид
		\[
			|\alpha q - p| \le \frac{1}{Q}
		\]
		Поделим обе части на $q$:
		\[
			\left|\alpha - \frac{p}{q}\right| \le \frac{1}{qQ} \le \frac{1}{q^2}
		\]
		
		\item Покажем наличие следующей дроби для данной. Рассмотрим $Q_1 \in \N \colon 1/Q_1 < |\alpha - p/q|$. По нему найдём соответствующие $p_1, q_1\ (q_1 \ge 1)$. Отсюда
		\[
			\left|\alpha - \frac{p_1}{q_1}\right| \le \frac{1}{q_1Q_1} \le \frac{1}{Q_1} < \left|\alpha - \frac{p}{q}\right|
		\]
	\end{enumerate}
\end{proof}

\subsubsection*{Конечные цепные дроби}

\begin{definition}
	Пусть есть числа $\{a_0, a_1, \ldots, a_n\}$, где $a_0 \in \Z, a_i \in \N$. Тогда назовём \textit{конечной цепной дробью} следующее выражение:
	\[
		[a_0; a_1, \ldots, a_n] := a_0 + \frac{1}{\dse a_1 + \frac{1}{\dse a_2 + \frac{1}{\dse \ddots + \frac{1}{a_n}}}}
	\]
	Числа $a_0, \ldots, a_n$ называются \textit{элементами цепной дроби}, они же \textit{неполные частные}.
	Более формально, можно определить цепную дробь через индукцию:
	\begin{itemize}
		\item \(\dse [a_0] = \frac{a_0}{1}\)
		\item \([a_0; a_1, \ldots, a_n] = a_0 + \displaystyle\frac{1}{[a_1; a_2, \ldots, a_n]} = a_0 + \frac{1}{p/q} = \frac{a_0p + q}{p}\)
	\end{itemize}
\end{definition}

\begin{definition}
	Назовём дробь, соответствующую цепной дроби $[a_0; a_1, \ldots, a_k] = p_k/q_k$ - \textit{подходящей}.
\end{definition}

\begin{note}
	В процессе приведения цепной дроби к виду $p/q$ мы \textbf{ничего не сокращаем}. Такой шаг позволяет нам точно приравнивать числители и знаменатели, исходя из определения подходящей дроби.
\end{note}

\begin{theorem}
	Для подходящих дробей числа $[a_0; a_1, \ldots, a_k]$ верны рекуррентные соотношения:
	\[
		\System{
			&{p_{k + 2} = a_{k + 2}p_{k + 1} + p_k}
			\\
			&{q_{k + 2} = a_{k + 2}q_{k + 1} + q_k}
		}
	\]
\end{theorem}

\begin{proof}
	Проведём индукцию по $k$:
	\begin{itemize}
		\item База $k = 0$: для дроби $[a_0; a_1, \ldots, a_n]$ должны быть выполнены соотношения:
		\[
			\System{
				&{p_{2} = a_{2}p_{1} + p_0}
				\\
				&{q_{2} = a_{2}q_{1} + q_0}
			}
		\]
		где $p_0 = a_0, q_0 = 1$, а $p_1, q_1$ найдём из записи числа $[a_0; a_1]$:
		\[
			[a_0; a_1] = a_0 + \frac{1}{a_1} = \frac{a_0 a_1 + 1}{a_1}
		\]
		Отсюда $p_1 = a_0 a_1 + 1,\ q_1 = a_1$. Осталось разобраться с $p_2, q_2$:
		\[
			[a_0; a_1, a_2] = a_0 + \frac{1}{[a_1; a_2]} = a_0 + \frac{a_2}{a_1 a_2 + 1} = \frac{a_0 a_1 a_2 + a_0 + a_2}{a_1 a_2 + 1} = \frac{p_2}{q_2}
		\]
		Подставим все найденные величины в потенциальные равенства:
		\[
			\System{
				&{a_0 a_1 a_2 + a_0 + a_2 = a_2 (a_0 a_1 + 1) + a_0}
				\\
				&{a_1 a_2 + 1 = a_2 a_1 + 1}
			}
		\]
		Верность очевидна.
		
		\item Переход $k > 0$:
		\[
			[a_0; a_1, \ldots, a_k] = a_0 + \frac{1}{[a_1; a_2, \ldots, a_k]}
		\]
		К дроби $[a_1; a_2, \ldots, a_k]$ примен\'{и}мо предположение индукции. Будем обозначать подходящие к ней, через $p'/q'$. Более точно
		\[
			[a_1; a_2, \ldots, a_i] =: \frac{p'_{i - 1}}{q'_{i - 1}}
		\]
		Подставим дробь вместо $[a_1; a_2, \ldots, a_k]$:
		\[
			[a_0; a_1, \ldots, a_k] = a_0 + \frac{q'_{k - 1}}{p'_{k - 1}} = \frac{a_0 p'_{k - 1} + q'_{k - 1}}{p'_{k - 1}} = \frac{p_k}{q_k}
		\]
		Отсюда можно получить другую рекуррентную систему, которая тоже верна
		\[
			\System{
				&{p_i = a_0 p'_{i - 1} + q'_{i - 1}}
				\\
				&{q_i = p'_{i - 1}}
			}
		\]
		По предположению индукции имеем
		\[
			\System{
				&{p'_{k - 1} = a_k p'_{k - 2} + p'_{k - 3}}
				\\
				&{q'_{k - 1} = a_k q'_{k - 2} + q'_{k - 3}}
			}
		\]
		Подставляя $p'_{i - 1}, q'_{i - 1}$, выраженные через первую систему, во вторую, получим требуемое:
		\[
			\System{
				&{q_k = a_k q_{k - 1} + q_{k - 2}}
				\\
				&{p_k = a_k p_{k - 1} + p_{k - 2} + a_0(q_k - a_k q_{k - 1} - q_{k - 2}) = a_k p_{k - 1} + p_{k - 2}}
			}
		\]
	\end{itemize}
\end{proof}

\begin{corollary}
	Домножим первое выражение на $q_{k + 1}$, а второе на $p_{k + 1}$ и вычтем одно из другого:
	\[
		q_{k + 1} p_{k + 2} - p_{k + 1} q_{k + 2} = p_k q_{k + 1} - q_k p_{k + 1}
	\]
	Попробуем последовательно вычислить данное соотношение:
	\begin{align*}
		&{p_0 q_1 - q_0 p_1 = a_0 a_1 - 1(a_0 a_1 + 1) = -1}
		\\
		&{p_1 q_2 - q_1 p_2 = -(p_0 q_1 - q_0 p_1) = 1}
		\\
		&{\vdots}
		\\
		&{}
	\end{align*}
	Или же сразу
	\[
		p_k q_{k + 1} - q_k p_{k + 1} = (-1)^{k + 1}
	\]
\end{corollary}

\begin{corollary}
	Из доказанного выше следует, что $\forall k \in \N \cup \{0\}\ \ p_k/q_k$ - несократимая дробь. Действительно, ведь если $(p_k, q_k) \neq 1$, то $(-1)^{k + 1}$ должно делиться на этот НОД. Значит, возможен лишь один вариант - они взаимно просты.
\end{corollary}

\begin{note}
	Перепишем равенство из следствия с следующем виде:
	\[
		\frac{p_k}{q_k} - \frac{p_{k + 1}}{q_{k + 1}} = \frac{(-1)^{k + 1}}{q_k q_{k + 1}}
	\]
	А теперь то же самое сделаем для дробей, отличающихся по номеру на 2:
	\[
		p_{k + 2}q_k - q_{k + 2} p_k = a_{k + 2}(p_{k + 1}q_k - q_{k + 1}p_k) \lra \frac{p_{k + 2}}{q_{k + 2}} - \frac{p_k}{q_k} = \frac{(-1)^k a_k}{q_k q_{k + 2}}
	\]
	Если $k$ - нечётный номер, то в первом равенстве справа стоит положительное число, то есть дробь $p_k/q_k$ больше следующей. Из второго равенства следует, что дроби с чётными номерами возрастают, а с нечётными - убывают. В общей картине это означает, что чётные дроби приближаются к $\alpha$ строго слева, а нечётные - строго справа.
	
	\textcolor{red}{Сюда бы картинку числовой прямой, где слева отмечены дроби с чётными номерами, а справа - с нечётными.}
	
	Если рассмотреть подходящие дроби как приближение к числу $\alpha$ (пока рациональному, но то же верно и для иррациональных), то для разности верна оценка:
	\[
		\left|\alpha - \frac{p_k}{q_k}\right| \le \left|\frac{p_{k + 1}}{q_{k + 1}} - \frac{p_k}{q_k}\right| = \left|\frac{p_{k + 1} q_k - q_{k + 1} p_k}{q_k q_{k + 1}}\right| = \frac{1}{q_k q_{k + 1}} \le \frac{1}{q_k^2}
	\]
\end{note}